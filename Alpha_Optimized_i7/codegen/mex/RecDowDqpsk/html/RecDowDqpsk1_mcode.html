<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">AberLevI</span>,<span class="var type1" id="S3T1U4">ValsLevI</span>,<span class="var type1" id="S4T1U5">AberLevQ</span>,<span class="var type1" id="S5T1U6">ValsLevQ</span>,<span class="var type1" id="S6T1U7">BerDQPSK</span>,<span class="var type1" id="S7T2U8">EoutI</span>,<span class="var type1" id="S8T2U9">EoutQ</span>,<span class="var type1" id="S9T2U10">TxDataOdd</span>,<span class="var type1" id="S10T2U11">TxDataEven</span>,<span class="var type1" id="S11T2U12">DataOdd</span>,<span class="var type1" id="S12T2U13">DataEven</span>,<span class="var type1" id="S13T1U14">LocMaxAB</span>,<span class="var type1" id="S14T1U15">MaxValAB</span>,<span class="var type1" id="S15T3U16">SeqFinAB</span>,<span class="var type1" id="S16T1U17">QMaxValAB</span>,<span class="var type1" id="S17T1U18">QLocMaxAB</span>,<span class="var type1" id="S18T3U19">QSeqFinAB</span>,<span class="var type1" id="S19T3U20">QInterAB</span>,<span class="var type1" id="S20T3U21">InterAB</span>,<span class="var type1" id="S21T2U22">IxAuxAB</span>,<span class="var type1" id="S22T2U23">QIxAuxAB</span>]=RecDowDqpsk(<span class="var type1" id="S23T4U26">EoutA</span>,<span class="var type1" id="S24T4U27">EoutB</span>,<span class="var type1" id="S25T4U28">EoutC</span>,<span class="var type1" id="S26T4U29">EoutD</span>,<span class="var type1" id="S27T1U30">T</span>,<span class="var type1" id="S28T1U31">Ta</span>,<span class="var type1" id="S29T1U32">IfftOrSum</span>,<span class="var type1" id="S30T1U33">MaxNumStag</span>,<span class="var type1" id="S31T1U34">StuffSampels</span>,<span class="var type1" id="S32T1U35">NbDQPSK</span>,<span class="var type1" id="S33T1U36">CurTesSiz</span>,<span class="var type1" id="S34T1U37">NumAmosCP</span>,<span class="var type1" id="S35T1U38">NPPB</span>,<span class="var type1" id="S36T1U39">SyncPeriod</span>,<span class="var type1" id="S37T4U40">TxDataMat</span>,<span class="var type1" id="S38T1U41">ThisCarr</span>,<span class="var type1" id="S39T1U42">LevDefDpqsk</span>,<span class="var type1" id="S40T1U43">AddCP</span>,<span class="var type1" id="S41T1U44">NumCarr</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line">    <span class="mxinfo " id="T4:U41"><span class="var type1" id="S7T4U47">EoutI</span> = (<span class="mxinfo " id="T4:U43"><span class="var type1" id="S24T4U50">EoutB</span> - <span class="var type1" id="S23T4U51">EoutA</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line">    <span class="mxinfo " id="T4:U46"><span class="var type1" id="S8T4U54">EoutQ</span> = (<span class="mxinfo " id="T4:U48"><span class="var type1" id="S26T4U57">EoutD</span> - <span class="var type1" id="S25T4U58">EoutC</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line">    <span class="mxinfo " id="T2:U51"><span class="var type1" id="S42T2U61">EmeaI</span> = <span class="mxinfo " id="T2:U53">mean(<span class="var type1" id="S7T4U64">EoutI</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line">    <span class="mxinfo " id="T2:U55"><span class="var type1" id="S44T2U67">EmeaQ</span> = <span class="mxinfo " id="T2:U57">mean(<span class="var type1" id="S8T4U70">EoutQ</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line">    <span class="mxinfo " id="T4:U59"><span class="var type1" id="S42T4U73">EmeaI</span> = <span class="mxinfo " id="T4:U61">repmat(<span class="var type1" id="S42T2U76">EmeaI</span>,<span class="mxinfo " id="T1:U63">size(<span class="var type1" id="S7T4U79">EoutI</span>,1)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line">    <span class="mxinfo " id="T4:U65"><span class="var type1" id="S44T4U84">EmeaQ</span> = <span class="mxinfo " id="T4:U67">repmat(<span class="var type1" id="S44T2U87">EmeaQ</span>,<span class="mxinfo " id="T1:U69">size(<span class="var type1" id="S8T4U90">EoutQ</span>,1)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line">    <span class="mxinfo " id="T4:U71"><span class="var type1" id="S7T4U95">EoutI</span> = <span class="mxinfo " id="T4:U73"><span class="var type1" id="S7T4U97">EoutI</span>-<span class="var type1" id="S42T4U98">EmeaI</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line">    <span class="mxinfo " id="T4:U76"><span class="var type1" id="S8T4U101">EoutQ</span> = <span class="mxinfo " id="T4:U78"><span class="var type1" id="S8T4U103">EoutQ</span>-<span class="var type1" id="S44T4U104">EmeaQ</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line">    <span class="mxinfo " id="T2:U81"><span class="var type1" id="S47T2U107">EmaxI</span> = <span class="mxinfo " id="T2:U83">max(<span class="var type1" id="S7T4U110">EoutI</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line">    <span class="mxinfo " id="T2:U85"><span class="var type1" id="S49T2U113">EmaxQ</span> = <span class="mxinfo " id="T2:U87">max(<span class="var type1" id="S8T4U116">EoutQ</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line">    <span class="mxinfo " id="T4:U89"><span class="var type1" id="S47T4U119">EmaxI</span> = <span class="mxinfo " id="T4:U91">repmat(<span class="var type1" id="S47T2U122">EmaxI</span>,<span class="mxinfo " id="T1:U93">size(<span class="var type1" id="S7T4U125">EoutI</span>,1)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line">    <span class="mxinfo " id="T4:U95"><span class="var type1" id="S49T4U130">EmaxQ</span> = <span class="mxinfo " id="T4:U97">repmat(<span class="var type1" id="S49T2U133">EmaxQ</span>,<span class="mxinfo " id="T1:U99">size(<span class="var type1" id="S8T4U136">EoutQ</span>,1)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line">    <span class="mxinfo " id="T4:U101"><span class="var type1" id="S7T4U141">EoutI</span> = <span class="mxinfo " id="T4:U103"><span class="var type1" id="S7T4U143">EoutI</span>./<span class="var type1" id="S47T4U144">EmaxI</span></span></span>;                                <span class="comment">%Normalizing the signal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line">    <span class="mxinfo " id="T4:U106"><span class="var type1" id="S8T4U147">EoutQ</span> = <span class="mxinfo " id="T4:U108"><span class="var type1" id="S8T4U149">EoutQ</span>./<span class="var type1" id="S49T4U150">EmaxQ</span></span></span>;                                <span class="comment">%Normalizing the signal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line">    <span class="comment">%EoutAuxF = 20*log10(abs(fftshift(fft(Ix)./length(Ix))));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line">    <span class="comment">%for jj=1:size(Ix,2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line">    <span class="comment">%VetElecPowerI(CurrentTest,ThisCarr,jj)= MeasPower(EoutI(:,jj));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line">    <span class="comment">%VetElecPowerQ(CurrentTest,ThisCarr,jj)= MeasPower(EoutQ(:,jj));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line">    <span class="comment">%VetElecPower(CurrentTest,ThisCarr,jj)= MeasPower(Ix(:,jj));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line">    <span class="comment">%[VetOptiPower(CurrentTest,ThisCarr,jj),~]= findpeaks(EoutAuxF(:,jj),'SortStr','descend','NPeaks',1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">    <span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">    <span class="comment">%SyncAuxI   = EoutI(IniSyncPos:SyncPos);                        %Selecting just the symbol to synchronize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">    <span class="comment">%SyncAuxQ   = EoutQ(IniSyncPos:SyncPos);                        %Selecting just the symbol to synchronize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">    <span class="comment">%                 PrintInfo(Ploting*22,t(IniSyncPos:SyncPos),EoutI(IniSyncPos:SyncPos),SyncSymb(IniSyncPos:SyncPos),EoutA(IniSyncPos:SyncPos),EoutB(IniSyncPos:SyncPos));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">    <span class="comment">%SyncedAux  = SyncSymb(IniSyncPos:SyncPos);                     %Selecting just the symbol to synchronize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">    <span class="comment">%                   Synchronizing</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">    <span class="comment">%This synchronization process is based on the mean expected</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">    <span class="comment">%value. That means, the information mean value should be within</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">    <span class="comment">%one period of symbol. Thus, the mean value of the received</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">    <span class="comment">%signal is acquired and compare of the known sync-word to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">    <span class="comment">%verify if this mean value is at the right possition. Which is</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">    <span class="comment">%the midel point (peak) of the highest level at the sync period</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">    <span class="comment">%SyncAuxI(EoutI(IniSyncPos:SyncPos)&lt;0.5*max((EoutI(IniSyncPos:SyncPos))))               = 0;   %To keep the mean value above zero anything under is neglected</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">    <span class="comment">%SyncAuxQ(EoutQ(IniSyncPos:SyncPos)&lt;0.5*max((EoutQ(IniSyncPos:SyncPos))))               = 0;   %To keep the mean value above zero anything under is neglected</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">    <span class="comment">%SyncAuxI(SyncAuxI&gt;=mean(SyncAuxI)) = 1;   %Adding a flag to the first sample of the received mean value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    <span class="comment">%SyncAuxQ(SyncAuxQ&gt;=mean(SyncAuxQ)) = 1;   %Adding a flag to the first sample of the received mean value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    <span class="comment">%SyncAuxI(SyncAuxI&lt;mean(SyncAuxI))  = -1;  %All the others samples at set to the lowest level</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="comment">%SyncAuxQ(SyncAuxQ&lt;mean(SyncAuxQ))  = -1;  %All the others samples at set to the lowest level</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="comment">%PosToSynI  = find(ismember(SyncAuxI,1));                       %Finding where is the location of the samples to synchronize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="comment">%PosToSynQ  = find(ismember(SyncAuxQ,1));                       %Finding where is the location of the samples to synchronize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="comment">%PosSynced = find(ismember(SyncedAux,1));                       %Finding where is the location of the samples to synchronize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">    <span class="comment">%DiffPosI = ExtDel*(PosToSynI(round(end/2)) - PosSynced(round(end/2)));  %Accounting the peak (midel point) displacement</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">    <span class="comment">%DiffPosQ = ExtDel*(PosToSynQ(round(end/2)) - PosSynced(round(end/2)));  %Accounting the peak (midel point) displacement</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">    <span class="mxinfo " id="T1:U111"><span class="var type1" id="S50T1U153">sn</span>=<span class="mxinfo " id="T1:U113">(<span class="mxinfo " id="T1:U114">(<span class="mxinfo " id="T1:U115"><span class="mxinfo " id="T1:U116">1</span>/<span class="mxinfo " id="T1:U117">2</span></span>)*(<span class="mxinfo " id="T1:U118">(<span class="mxinfo " id="T1:U119">(<span class="mxinfo " id="T1:U120">1/2</span>)^<span class="var type1" id="S30T1U169">MaxNumStag</span></span>)-<span class="mxinfo " id="T1:U122">1</span></span>)</span>)/(<span class="mxinfo " id="T1:U123">(1/2)-1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">    <span class="mxinfo " id="T1:U124"><span class="var type1" id="S51T1U180">DiffPosI</span> = <span class="mxinfo " id="T1:U126">round(<span class="mxinfo " id="T1:U127"><span class="mxinfo " id="T1:U128">(<span class="mxinfo " id="T1:U129"><span class="var type1" id="S50T1U187">sn</span>/(<span class="mxinfo " id="T1:U131"><span class="mxinfo " id="T1:U132">3</span>/<span class="mxinfo " id="T1:U133"><span class="mxinfo " id="T1:U134">2.55</span>^<span class="var type1" id="S29T1U193">IfftOrSum</span></span></span>)</span>)*<span class="var type1" id="S27T1U194">T</span></span>/<span class="var type1" id="S28T1U195">Ta</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">    <span class="mxinfo " id="T1:U138"><span class="var type1" id="S53T1U198">DiffPosQ</span> = <span class="mxinfo " id="T1:U140">round(<span class="mxinfo " id="T1:U141"><span class="mxinfo " id="T1:U142">(<span class="mxinfo " id="T1:U143"><span class="var type1" id="S50T1U205">sn</span>/(<span class="mxinfo " id="T1:U145"><span class="mxinfo " id="T1:U146">3</span>/<span class="mxinfo " id="T1:U147"><span class="mxinfo " id="T1:U148">2.55</span>^<span class="var type1" id="S29T1U211">IfftOrSum</span></span></span>)</span>)*<span class="var type1" id="S27T1U212">T</span></span>/<span class="var type1" id="S28T1U213">Ta</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">    <span class="mxinfo " id="T4:U152"><span class="var type1" id="S7T4U216">EoutI</span> = <span class="mxinfo " id="T4:U154">[<span class="mxinfo " id="T4:U155"><span class="var type1" id="S7T4U220">EoutI</span>(<span class="mxinfo " id="T2:U157"><span class="mxinfo " id="T1:U158"><span class="var type1" id="S51T1U223">DiffPosI</span>+<span class="mxinfo " id="T1:U160">1</span></span>:end</span>,<span class="mxinfo " id="T5:U161">:</span>)</span>;<span class="mxinfo " id="T4:U162"><span class="var type1" id="S7T4U230">EoutI</span>(<span class="mxinfo " id="T2:U164"><span class="mxinfo " id="T1:U165">1</span>:<span class="var type1" id="S51T1U233">DiffPosI</span></span>,<span class="mxinfo " id="T5:U167">:</span>)</span>]</span></span>;   <span class="comment">%Shift based on sampling sliding</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">    <span class="mxinfo " id="T4:U168"><span class="var type1" id="S8T4U237">EoutQ</span> = <span class="mxinfo " id="T4:U170">[<span class="mxinfo " id="T4:U171"><span class="var type1" id="S8T4U241">EoutQ</span>(<span class="mxinfo " id="T2:U173"><span class="mxinfo " id="T1:U174"><span class="var type1" id="S53T1U244">DiffPosQ</span>+<span class="mxinfo " id="T1:U176">1</span></span>:end</span>,<span class="mxinfo " id="T5:U177">:</span>)</span>;<span class="mxinfo " id="T4:U178"><span class="var type1" id="S8T4U251">EoutQ</span>(<span class="mxinfo " id="T2:U180"><span class="mxinfo " id="T1:U181">1</span>:<span class="var type1" id="S53T1U254">DiffPosQ</span></span>,<span class="mxinfo " id="T5:U183">:</span>)</span>]</span></span>;   <span class="comment">%Shift based on sampling sliding</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">    <span class="comment">%if DiffPosI&gt;=0%If the difference is positive, left-shift<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">    <span class="comment">%EoutI = ifft(fft(EoutI).*exp(1j*2*pi*f*(DiffPosI*Ta))); %Shift based on time change</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    <span class="comment">%EoutI = [EoutI(DiffPosI+1:end) EoutI(1:DiffPosI)];   %Shift based on sampling sliding</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">    <span class="comment">%EoutQ = [EoutQ(DiffPosI+1:end) EoutQ(1:DiffPosI)];   %Shift based on sampling sliding</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">    <span class="comment">%else%<span class="keyword">...</span><span class="comment"> but if the difference is negative, right-shift</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">    <span class="comment">%EoutI = ifft(fft(EoutI).*exp(-1j*2*pi*f*(DiffPosI*Ta))); %Shift based on time change</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">    <span class="comment">%EoutI = [EoutI(end+DiffPosI+1:end) EoutI(1:end+DiffPosI)]; %Shift based on sampling sliding</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">    <span class="comment">%EoutQ = [EoutQ(end+DiffPosI+1:end) EoutQ(1:end+DiffPosI)]; %Shift based on sampling sliding</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">    <span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">    <span class="comment">%%                   Plot for Qualitative analizes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">    <span class="comment">%                              PrintInfo(Ploting*22,t(IniSyncPos:SyncPos),EoutI(IniSyncPos<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="comment">%                              :SyncPos),SyncSymb(IniSyncPos:SyncPos),EoutA(IniSyncPos:<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">    <span class="comment">%                                                       SyncPos),EoutB(IniSyncPos:SyncPos));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">    <span class="comment">%                              PrintInfo(Ploting*22,t(IniSyncPos:SyncPos),EoutQ(IniSyncPos<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">    <span class="comment">%                              :SyncPos),SyncSymb(IniSyncPos:SyncPos),EoutC(IniSyncPos:<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">    <span class="comment">%                                                       SyncPos),EoutD(IniSyncPos:SyncPos));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">    <span class="comment">%% Removing CP</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S40T1U258">AddCP</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">        <span class="mxinfo " id="T4:U185"><span class="var type1" id="S55T4U261">IxAux1</span>  = <span class="mxinfo " id="T4:U187"><span class="var type1" id="S7T4U263">EoutI</span>(<span class="mxinfo " id="T2:U189"><span class="mxinfo " id="T1:U190">1</span>:<span class="mxinfo " id="T1:U191"><span class="mxinfo " id="T1:U192">end</span> - <span class="var type1" id="S31T1U269">StuffSampels</span></span></span>,<span class="mxinfo " id="T5:U194">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">        <span class="mxinfo " id="T4:U195"><span class="var type1" id="S55T4U273">IxAux1</span>  = <span class="mxinfo " id="T4:U197">reshape(<span class="var type1" id="S55T4U276">IxAux1</span>,(<span class="mxinfo " id="T1:U199"><span class="mxinfo " id="T1:U200"><span class="mxinfo " id="T1:U201">2</span>*<span class="var type1" id="S34T1U281">NumAmosCP</span></span>+<span class="var type1" id="S35T1U282">NPPB</span></span>),<span class="mxinfo " id="T1:U204">(<span class="mxinfo " id="T1:U205"><span class="var type1" id="S32T1U286">NbDQPSK</span>/<span class="mxinfo " id="T1:U207">2</span></span>)*<span class="var type1" id="S33T1U288">CurTesSiz</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">        <span class="mxinfo " id="T4:U209"><span class="var type1" id="S55T4U291">IxAux1</span>  = <span class="mxinfo " id="T4:U211"><span class="var type1" id="S55T4U293">IxAux1</span>(<span class="mxinfo " id="T2:U213"><span class="mxinfo " id="T1:U214"><span class="mxinfo " id="T1:U215">1</span>+<span class="var type1" id="S34T1U297">NumAmosCP</span></span>:<span class="mxinfo " id="T1:U217"><span class="mxinfo " id="T1:U218">end</span>-<span class="var type1" id="S34T1U301">NumAmosCP</span></span></span>,<span class="mxinfo " id="T5:U220">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">        <span class="mxinfo " id="T4:U221"><span class="var type1" id="S55T4U305">IxAux1</span>  = <span class="mxinfo " id="T4:U223">reshape(<span class="var type1" id="S55T4U308">IxAux1</span>,<span class="mxinfo " id="T1:U225"><span class="var type1" id="S35T1U310">NPPB</span>*(<span class="mxinfo " id="T1:U227"><span class="var type1" id="S32T1U313">NbDQPSK</span>/<span class="mxinfo " id="T1:U229">2</span></span>)</span>,<span class="var type1" id="S33T1U315">CurTesSiz</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">        <span class="mxinfo " id="T4:U231"><span class="var type1" id="S7T4U318">EoutI</span>  = <span class="var type1" id="S55T4U319">IxAux1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">        <span class="mxinfo " id="T4:U234"><span class="var type1" id="S57T4U322">IxAux2</span>  = <span class="mxinfo " id="T4:U236"><span class="var type1" id="S8T4U324">EoutQ</span>(<span class="mxinfo " id="T2:U238"><span class="mxinfo " id="T1:U239">1</span>:<span class="mxinfo " id="T1:U240"><span class="mxinfo " id="T1:U241">end</span> - <span class="var type1" id="S31T1U330">StuffSampels</span></span></span>,<span class="mxinfo " id="T5:U243">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">        <span class="mxinfo " id="T4:U244"><span class="var type1" id="S57T4U334">IxAux2</span>  = <span class="mxinfo " id="T4:U246">reshape(<span class="var type1" id="S57T4U337">IxAux2</span>,(<span class="mxinfo " id="T1:U248"><span class="mxinfo " id="T1:U249"><span class="mxinfo " id="T1:U250">2</span>*<span class="var type1" id="S34T1U342">NumAmosCP</span></span>+<span class="var type1" id="S35T1U343">NPPB</span></span>),<span class="mxinfo " id="T1:U253">(<span class="mxinfo " id="T1:U254"><span class="var type1" id="S32T1U347">NbDQPSK</span>/<span class="mxinfo " id="T1:U256">2</span></span>)*<span class="var type1" id="S33T1U349">CurTesSiz</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">        <span class="mxinfo " id="T4:U258"><span class="var type1" id="S57T4U352">IxAux2</span>  = <span class="mxinfo " id="T4:U260"><span class="var type1" id="S57T4U354">IxAux2</span>(<span class="mxinfo " id="T2:U262"><span class="mxinfo " id="T1:U263"><span class="mxinfo " id="T1:U264">1</span>+<span class="var type1" id="S34T1U358">NumAmosCP</span></span>:<span class="mxinfo " id="T1:U266"><span class="mxinfo " id="T1:U267">end</span>-<span class="var type1" id="S34T1U362">NumAmosCP</span></span></span>,<span class="mxinfo " id="T5:U269">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">        <span class="mxinfo " id="T4:U270"><span class="var type1" id="S57T4U366">IxAux2</span>  = <span class="mxinfo " id="T4:U272">reshape(<span class="var type1" id="S57T4U369">IxAux2</span>,<span class="mxinfo " id="T1:U274"><span class="var type1" id="S35T1U371">NPPB</span>*(<span class="mxinfo " id="T1:U276"><span class="var type1" id="S32T1U374">NbDQPSK</span>/<span class="mxinfo " id="T1:U278">2</span></span>)</span>,<span class="var type1" id="S33T1U376">CurTesSiz</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">        <span class="mxinfo " id="T4:U280"><span class="var type1" id="S8T4U379">EoutQ</span>  = <span class="var type1" id="S57T4U380">IxAux2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">    <span class="comment">%% Taking the sampling the EVM meassurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">    <span class="comment">%clear IxAux;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">    <span class="comment">%PosAuxEout1 = NPPB/2:NPPB:length(EoutI);%Varriable respossible to take just the samples at the middle of the symbol</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">    <span class="comment">%PosAuxEout2 = ((NPPB/2)+(NPPB/4)):NPPB:length(EoutI);%Varriable respossible to take just the samples at the middle of the symbol</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">    <span class="comment">%PosAuxEout3 = ((NPPB/2)-(NPPB/4)):NPPB:length(EoutI);%Varriable respossible to take just the samples at the middle of the symbol</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">    <span class="comment">%IxAux1      = EoutI(PosAuxEout1) + 1j.*EoutQ(PosAuxEout1);    %Normalizing the reference</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">    <span class="comment">%IxAux2      = EoutI(PosAuxEout2) + 1j.*EoutQ(PosAuxEout2);    %Normalizing the reference</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">    <span class="comment">%IxAux3      = EoutI(PosAuxEout3) + 1j.*EoutQ(PosAuxEout3);    %Normalizing the reference</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">    <span class="comment">%a=a+0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">    <span class="comment">%EvmMatRecA(1,:) = IxAux1;                       %Taking just the middle samples as references</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">    <span class="comment">%EvmMatRecA(2,:) = IxAux2;                       %Taking just the middle samples as references</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">    <span class="comment">%EvmMatRecA(3,:) = IxAux3;                       %Taking just the middle samples as references</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">    <span class="comment">%EvmMatRecA(4,:) = IxAux1;                       %Taking just the middle samples as references</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">    <span class="comment">%[EvmDBA(1), EvmPerA(1), EvmRmsA(1) ] = EvmCalc( EvmMatRef(ObsCarrPos==ThisCarr,:),IxAux1 );</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">    <span class="comment">%[EvmDBA(2), EvmPerA(2), EvmRmsA(2) ] = EvmCalc( EvmMatRef(ObsCarrPos==ThisCarr,:),IxAux2 );</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">    <span class="comment">%[EvmDBA(3), EvmPerA(3), EvmRmsA(3) ] = EvmCalc( EvmMatRef(ObsCarrPos==ThisCarr,:),IxAux3 );</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">    <span class="comment">%[EvmDBA(4), EvmPerA(4), EvmRmsA(4) ] = EvmCalc( EvmMatRef(ObsCarrPos==ThisCarr,:),IxAux1 );</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">    <span class="comment">%[EvmDBJA(1),EvmPerJA(1),EvmRmsJA(1)] = evm1(4,'dpsk',EvmMatRef(ObsCarrPos==ThisCarr,:),IxAux1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="comment">%[EvmDBJA(2),EvmPerJA(2),EvmRmsJA(2)] = evm1(4,'dpsk',EvmMatRef(ObsCarrPos==ThisCarr,:),IxAux2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">    <span class="comment">%[EvmDBJA(3),EvmPerJA(3),EvmRmsJA(3)] = evm1(4,'dpsk',EvmMatRef(ObsCarrPos==ThisCarr,:),IxAux3);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">    <span class="comment">%[EvmDBJA(4),EvmPerJA(4),EvmRmsJA(4)] = evm1(4,'dpsk',EvmMatRef(ObsCarrPos==ThisCarr,:),IxAux1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">    <span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">    <span class="comment">%                 figure;plot(t(1:length(E_rec3)),abs(E_rec3),t(1:length(EoutQ)),EoutQ,t(1:length(EoutI)),EoutI);set(gcf,'units','normalized','outerposition',[0 0 0.5 1]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">    <span class="comment">%One important step on this project was the confirmation of our</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">    <span class="comment">%results from a closed and theoretical equation that relates</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">    <span class="comment">%the income optical field witht its respective data (as</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">    <span class="comment">%descrived above in the receiving process). The result from</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">    <span class="comment">%this equation was further compared with the result from the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">    <span class="comment">%MZ-Interferometer as an proof of concept. This equation can be</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">    <span class="comment">%found at the book of Optical Fiber Telecommunications V B,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">    <span class="comment">%which one of the authors is Ivan P. Kaminow at the page 144.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">    <span class="comment">%                                 taux = t(1:length(E_rec3));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">    <span class="comment">%                                 faux = time2freq(taux);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">    <span class="comment">%                                 Ui = real(exp(1j*pi/4).*E_rec3.*conj(ifft(fft(E_rec3).*exp(-<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">    <span class="comment">%                                     1j*2*pi*faux*T))));%The data at odd position</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">    <span class="comment">%                                 Ui = Ui./max(abs(Ui));                                         %Normalizing the signal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">    <span class="comment">%                                 Uq = imag(exp(1j*pi/4).*E_rec3.*conj(ifft(fft(E_rec3).*exp(-<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">    <span class="comment">%                                     1j*2*pi*faux*T))));%The data at the even position</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">    <span class="comment">%                                 Uq = Uq./max(abs(Uq));                                         %Normalizing the signal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">    <span class="comment">%##########################################################################</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">    <span class="mxinfo " id="T4:U283"><span class="var type1" id="S7T4U383">EoutI</span> = <span class="mxinfo " id="T4:U285"><span class="var type1" id="S7T4U385">EoutI</span>(<span class="mxinfo " id="T2:U287"><span class="mxinfo " id="T1:U288"><span class="mxinfo " id="T1:U289">1</span>+<span class="mxinfo " id="T1:U290"><span class="var type1" id="S36T1U390">SyncPeriod</span>*<span class="var type1" id="S35T1U391">NPPB</span></span></span>:<span class="mxinfo " id="T1:U293"><span class="mxinfo " id="T1:U294">end</span>-<span class="mxinfo " id="T1:U295"><span class="var type1" id="S36T1U396">SyncPeriod</span>*<span class="var type1" id="S35T1U397">NPPB</span></span></span></span>,<span class="mxinfo " id="T5:U298">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">    <span class="mxinfo " id="T2:U299"><span class="var type1" id="S7T2U401">EoutI</span> = <span class="mxinfo " id="T2:U301">reshape(<span class="var type1" id="S7T4U404">EoutI</span>,1,<span class="mxinfo " id="T1:U303"><span class="mxinfo " id="T1:U304">size(<span class="var type1" id="S7T4U409">EoutI</span>,1)</span>*<span class="mxinfo " id="T1:U306">size(<span class="var type1" id="S7T4U413">EoutI</span>,2)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">    <span class="mxinfo " id="T4:U308"><span class="var type1" id="S8T4U417">EoutQ</span> = <span class="mxinfo " id="T4:U310"><span class="var type1" id="S8T4U419">EoutQ</span>(<span class="mxinfo " id="T2:U312"><span class="mxinfo " id="T1:U313"><span class="mxinfo " id="T1:U314">1</span>+<span class="mxinfo " id="T1:U315"><span class="var type1" id="S36T1U424">SyncPeriod</span>*<span class="var type1" id="S35T1U425">NPPB</span></span></span>:<span class="mxinfo " id="T1:U318"><span class="mxinfo " id="T1:U319">end</span>-<span class="mxinfo " id="T1:U320"><span class="var type1" id="S36T1U430">SyncPeriod</span>*<span class="var type1" id="S35T1U431">NPPB</span></span></span></span>,<span class="mxinfo " id="T5:U323">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">    <span class="mxinfo " id="T2:U324"><span class="var type1" id="S8T2U435">EoutQ</span> = <span class="mxinfo " id="T2:U326">reshape(<span class="var type1" id="S8T4U438">EoutQ</span>,1,<span class="mxinfo " id="T1:U328"><span class="mxinfo " id="T1:U329">size(<span class="var type1" id="S8T4U443">EoutQ</span>,1)</span>*<span class="mxinfo " id="T1:U331">size(<span class="var type1" id="S8T4U447">EoutQ</span>,2)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">    <span class="mxinfo " id="T2:U333"><span class="var type1" id="S58T2U451">PosIx</span> = <span class="mxinfo " id="T2:U335"><span class="mxinfo " id="T1:U336"><span class="var type1" id="S35T1U455">NPPB</span>/<span class="mxinfo " id="T1:U338">2</span></span>:<span class="var type1" id="S35T1U457">NPPB</span>:<span class="mxinfo " id="T1:U340">length(<span class="var type1" id="S7T2U460">EoutI</span>)</span></span></span>;                                <span class="comment">%Possition of the central samples - but the number of samples per symbol is even ????</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">    <span class="comment">%IxAux = EoutI(PosIx);                                             %From the main received signal just a few samples are taken for further evaluation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">    <span class="mxinfo " id="T1:U342"><span class="var type1" id="S60T1U463">n</span>     = <span class="mxinfo " id="T1:U344">100</span></span>;                                                   <span class="comment">%The number of boxes to be filled up on the histogram process</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">    <span class="mxinfo " id="T1:U345"><span class="var type1" id="S61T1U467">Perce</span> = <span class="mxinfo " id="T1:U347">0.7</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">    <span class="comment">%At this process each eye will be evaluated separetelly. It is</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">    <span class="comment">%important to remember that the PAM4 has 4 levels, which means</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">    <span class="comment">%three level of decissions that are exaclty the center of the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">    <span class="comment">%eye diagram.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">    <span class="mxinfo " id="T2:U348"><span class="var type1" id="S21T2U471">IxAuxAB</span> = <span class="mxinfo " id="T2:U350"><span class="var type1" id="S7T2U473">EoutI</span>(<span class="var type1" id="S58T2U474">PosIx</span>)</span></span>;       <span class="comment">%Taking just those values relative to the uper eye</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">    <span class="mxinfo " id="T3:U353"><span class="var type1" id="S20T3U477">InterAB</span> = <span class="mxinfo " id="T3:U355">linspace(<span class="mxinfo " id="T1:U356"><span class="var type1" id="S61T1U481">Perce</span>*(<span class="mxinfo " id="T1:U358">min(<span class="var type1" id="S7T2U485">EoutI</span>)</span>)</span>,<span class="mxinfo " id="T1:U360"><span class="var type1" id="S61T1U487">Perce</span>*(<span class="mxinfo " id="T1:U362">max(<span class="var type1" id="S7T2U491">EoutI</span>)</span>)</span>,<span class="var type1" id="S60T1U492">n</span>)</span></span>;                     <span class="comment">%Building the histogram boxes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">    <span class="mxinfo " id="T3:U365"><span class="var type1" id="S64T3U495">EyeAB</span> = <span class="mxinfo " id="T3:U367">hist(<span class="var type1" id="S21T2U498">IxAuxAB</span>,<span class="var type1" id="S20T3U499">InterAB</span>)</span></span>;                                 <span class="comment">%filling up the boxes with samples that fit on them.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">    <span class="mxinfo " id="T2:U370"><span class="var type1" id="S22T2U502">QIxAuxAB</span> = <span class="mxinfo " id="T2:U372"><span class="var type1" id="S8T2U504">EoutQ</span>(<span class="var type1" id="S58T2U505">PosIx</span>)</span></span>;       <span class="comment">%Taking just those values relative to the uper eye</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo " id="T3:U375"><span class="var type1" id="S19T3U508">QInterAB</span> = <span class="mxinfo " id="T3:U377">linspace(<span class="mxinfo " id="T1:U378"><span class="var type1" id="S61T1U512">Perce</span>*(<span class="mxinfo " id="T1:U380">min(<span class="var type1" id="S8T2U516">EoutQ</span>)</span>)</span>,<span class="mxinfo " id="T1:U382"><span class="var type1" id="S61T1U518">Perce</span>*(<span class="mxinfo " id="T1:U384">max(<span class="var type1" id="S8T2U522">EoutQ</span>)</span>)</span>,<span class="var type1" id="S60T1U523">n</span>)</span></span>;                     <span class="comment">%Building the histogram boxes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">    <span class="mxinfo " id="T3:U387"><span class="var type1" id="S66T3U526">QEyeAB</span> = <span class="mxinfo " id="T3:U389">hist(<span class="var type1" id="S22T2U529">QIxAuxAB</span>,<span class="var type1" id="S19T3U530">QInterAB</span>)</span></span>;                                 <span class="comment">%filling up the boxes with samples that fit on them.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">    <span class="comment">%The same process described for the uper level will be done at</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">    <span class="comment">%the middle and lower eyes levels.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">    <span class="comment">%What we are looking for here are not where exist the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">    <span class="comment">%occurrences of values. The eye is where there is not samples,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">    <span class="comment">%this means, the decission level is a reagion between actual</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">    <span class="comment">%levels thus this reagion does not contain any signal.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">    <span class="mxinfo " id="T6:U392"><span class="var type1" id="S64T6U533">EyeAB</span> = <span class="mxinfo " id="T6:U394">~<span class="var type1" id="S64T3U535">EyeAB</span></span></span>;                                                <span class="comment">%Changing zeros to one - Zeros compose the eye region</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">    <span class="mxinfo " id="T6:U396"><span class="var type1" id="S66T6U538">QEyeAB</span> = <span class="mxinfo " id="T6:U398">~<span class="var type1" id="S66T3U540">QEyeAB</span></span></span>;                                                <span class="comment">%Changing zeros to one - Zeros compose the eye region</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">    <span class="comment">%Starting variables that will be used to identify the eye</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">    <span class="comment">%diagram.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line">    <span class="mxinfo " id="T1:U400"><span class="var type1" id="S67T1U543">CountAB</span>   = <span class="mxinfo " id="T1:U402">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line">    <span class="mxinfo " id="T1:U403"><span class="var type1" id="S68T1U547">QCountAB</span>   = <span class="mxinfo " id="T1:U405">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line">    <span class="mxinfo " id="T3:U406"><span class="var type1" id="S69T3U551">SeqOnesAB</span> = <span class="mxinfo " id="T3:U408">zeros(<span class="mxinfo " id="T1:U409">1</span>,<span class="mxinfo " id="T1:U410">length(<span class="var type1" id="S64T6U557">EyeAB</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line">    <span class="mxinfo " id="T3:U412"><span class="var type1" id="S71T3U560">QSeqOnesAB</span> = <span class="mxinfo " id="T3:U414">zeros(<span class="mxinfo " id="T1:U415">1</span>,<span class="mxinfo " id="T1:U416">length(<span class="var type1" id="S64T6U566">EyeAB</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line">    <span class="mxinfo " id="T3:U418"><span class="var type1" id="S15T3U569">SeqFinAB</span>  = <span class="mxinfo " id="T3:U420">zeros(<span class="mxinfo " id="T1:U421">1</span>,<span class="mxinfo " id="T1:U422">length(<span class="var type1" id="S64T6U575">EyeAB</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">    <span class="mxinfo " id="T3:U424"><span class="var type1" id="S18T3U578">QSeqFinAB</span>  = <span class="mxinfo " id="T3:U426">zeros(<span class="mxinfo " id="T1:U427">1</span>,<span class="mxinfo " id="T1:U428">length(<span class="var type1" id="S64T6U584">EyeAB</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line">    <span class="mxinfo " id="T1:U430"><span class="var type1" id="S72T1U587">SeqIniAB</span>  = <span class="mxinfo " id="T1:U432">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line">    <span class="mxinfo " id="T1:U433"><span class="var type1" id="S73T1U591">QSeqIniAB</span>  = <span class="mxinfo " id="T1:U435">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">    <span class="comment">%The for loop will take account of every box with ones. It is</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">    <span class="comment">%important to take note that the not operator was used in this</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line">    <span class="comment">%vector, therefore ones means zeros (the eye diagram -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">    <span class="comment">%possibly) and zeros means values abouve zeroa (not the eye).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S74T1U595">kk</span>=<span class="mxinfo " id="T1:U437">1</span>:length(<span class="var type1" id="S64T6U600">EyeAB</span>)                                         <span class="comment">%For every box</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U439"><span class="var type1" id="S64T6U604">EyeAB</span>(<span class="var type1" id="S74T1U605">kk</span>)</span>                                               <span class="comment">%if it contains "1"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line">            <span class="mxinfo " id="T1:U442"><span class="mxinfo " id="T1:U443"><span class="var type1" id="S69T3U609">SeqOnesAB</span>(<span class="var type1" id="S72T1U610">SeqIniAB</span>)</span>=<span class="var type1" id="S67T1U611">CountAB</span></span>;                           <span class="comment">%count this element as part of a consecutive sequency</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line">            <span class="mxinfo " id="T1:U447"><span class="var type1" id="S67T1U614">CountAB</span> = <span class="mxinfo " id="T1:U449"><span class="var type1" id="S67T1U616">CountAB</span> + <span class="mxinfo " id="T1:U451">1</span></span></span>;                                 <span class="comment">%adds one to the counter of consecutive elements "1"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T7:U452"><span class="var type1" id="S74T1U621">kk</span>==<span class="mxinfo " id="T1:U454">length(<span class="var type1" id="S64T6U624">EyeAB</span>)</span></span>                                   <span class="comment">%if the current box is the last box we got to an end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">                <span class="mxinfo " id="T1:U456"><span class="mxinfo " id="T1:U457"><span class="var type1" id="S15T3U628">SeqFinAB</span>(<span class="var type1" id="S72T1U629">SeqIniAB</span>)</span> = <span class="var type1" id="S74T1U630">kk</span></span>;                           <span class="comment">%The final sequency element is equal to its possition (kk)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line">        <span class="keyword">else</span>                                                       <span class="comment">%else if the current box contains "0"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line">            <span class="mxinfo " id="T1:U461"><span class="mxinfo " id="T1:U462"><span class="var type1" id="S15T3U635">SeqFinAB</span>(<span class="var type1" id="S72T1U636">SeqIniAB</span>)</span> = <span class="mxinfo " id="T1:U465"><span class="var type1" id="S74T1U638">kk</span>-<span class="mxinfo " id="T1:U467">1</span></span></span>;                             <span class="comment">%the previous element was the last element of a consecutive sequency of ones</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">            <span class="mxinfo " id="T1:U468"><span class="var type1" id="S72T1U642">SeqIniAB</span> = <span class="mxinfo " id="T1:U470"><span class="var type1" id="S72T1U644">SeqIniAB</span> + <span class="mxinfo " id="T1:U472">1</span></span></span>;                               <span class="comment">%adds one to the counter of consecutive number (take in account how many sequencies there are)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">            <span class="mxinfo " id="T1:U473"><span class="var type1" id="S67T1U648">CountAB</span> = <span class="mxinfo " id="T1:U475">1</span></span>;                                           <span class="comment">%reset the counter of consecutive elements to mark the start of a new consecutive sequence</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U476"><span class="var type1" id="S66T6U653">QEyeAB</span>(<span class="var type1" id="S74T1U654">kk</span>)</span>                                               <span class="comment">%if it contains "1"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">            <span class="mxinfo " id="T1:U479"><span class="mxinfo " id="T1:U480"><span class="var type1" id="S71T3U658">QSeqOnesAB</span>(<span class="var type1" id="S73T1U659">QSeqIniAB</span>)</span>=<span class="var type1" id="S68T1U660">QCountAB</span></span>;                           <span class="comment">%count this element as part of a consecutive sequency</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">            <span class="mxinfo " id="T1:U484"><span class="var type1" id="S68T1U663">QCountAB</span> = <span class="mxinfo " id="T1:U486"><span class="var type1" id="S68T1U665">QCountAB</span> + <span class="mxinfo " id="T1:U488">1</span></span></span>;                                 <span class="comment">%adds one to the counter of consecutive elements "1"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T7:U489"><span class="var type1" id="S74T1U670">kk</span>==<span class="mxinfo " id="T1:U491">length(<span class="var type1" id="S66T6U673">QEyeAB</span>)</span></span>                                   <span class="comment">%if the current box is the last box we got to an end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">                <span class="mxinfo " id="T1:U493"><span class="mxinfo " id="T1:U494"><span class="var type1" id="S18T3U677">QSeqFinAB</span>(<span class="var type1" id="S73T1U678">QSeqIniAB</span>)</span> = <span class="var type1" id="S74T1U679">kk</span></span>;                           <span class="comment">%The final sequency element is equal to its possition (kk)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">        <span class="keyword">else</span>                                                       <span class="comment">%else if the current box contains "0"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">            <span class="mxinfo " id="T1:U498"><span class="mxinfo " id="T1:U499"><span class="var type1" id="S18T3U684">QSeqFinAB</span>(<span class="var type1" id="S73T1U685">QSeqIniAB</span>)</span> = <span class="mxinfo " id="T1:U502"><span class="var type1" id="S74T1U687">kk</span>-<span class="mxinfo " id="T1:U504">1</span></span></span>;                             <span class="comment">%the previous element was the last element of a consecutive sequency of ones</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">            <span class="mxinfo " id="T1:U505"><span class="var type1" id="S73T1U691">QSeqIniAB</span> = <span class="mxinfo " id="T1:U507"><span class="var type1" id="S73T1U693">QSeqIniAB</span> + <span class="mxinfo " id="T1:U509">1</span></span></span>;                               <span class="comment">%adds one to the counter of consecutive number (take in account how many sequencies there are)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line">            <span class="mxinfo " id="T1:U510"><span class="var type1" id="S68T1U697">QCountAB</span> = <span class="mxinfo " id="T1:U512">1</span></span>;                                           <span class="comment">%reset the counter of consecutive elements to mark the start of a new consecutive sequence</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">    <span class="comment">%If the eye is open, which means there is a clear difference</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">    <span class="comment">%between adjacent levels, the eye diagram will be the longest</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">    <span class="comment">%sequence of ones.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line">    [<span class="var type1" id="S14T1U702">MaxValAB</span>,<span class="var type1" id="S13T1U703">LocMaxAB</span>]=max(<span class="var type1" id="S69T3U706">SeqOnesAB</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">    <span class="mxinfo " id="T7:U516"><span class="keyword">if</span> <span class="mxinfo " id="T7:U517"><span class="mxinfo " id="T7:U518"><span class="var type1" id="S13T1U711">LocMaxAB</span>&lt;<span class="mxinfo " id="T1:U520">2</span></span> || <span class="mxinfo " id="T7:U521"><span class="var type1" id="S14T1U714">MaxValAB</span>&lt;<span class="mxinfo " id="T1:U523">2</span></span></span>                                    <span class="comment">%if any sequency was found or there is just one sequency it is a error thus</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">        <span class="mxinfo " id="T1:U524"><span class="var type1" id="S75T1U718">LevDec3</span> = <span class="mxinfo " id="T1:U526">0.1</span></span>;                                            <span class="comment">%the decission level will be by default 0.67. Also, the other variables will</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line">        <span class="mxinfo " id="T1:U527"><span class="var type1" id="S13T1U722">LocMaxAB</span> = <span class="mxinfo " id="T1:U529">1</span></span>;                                              <span class="comment">%will be set with values to not cause errors in the future</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">        <span class="mxinfo " id="T1:U530"><span class="mxinfo " id="T1:U531"><span class="var type1" id="S15T3U727">SeqFinAB</span>(<span class="mxinfo " id="T1:U533">1</span>)</span>=<span class="mxinfo " id="T1:U534">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line">        <span class="mxinfo " id="T1:U535"><span class="var type1" id="S14T1U732">MaxValAB</span> = <span class="mxinfo " id="T1:U537">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">        <span class="mxinfo " id="T1:U538"><span class="mxinfo " id="T1:U539"><span class="var type1" id="S20T3U737">InterAB</span>(<span class="mxinfo " id="T1:U541">1</span>)</span>=<span class="var type1" id="S75T1U739">LevDec3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">    <span class="keyword">else</span>                                                           <span class="comment">%if a sequency was found the middle of the eye will be the middle of the sequency</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U543">(<span class="mxinfo " id="T1:U544"><span class="mxinfo " id="T1:U545"><span class="var type1" id="S15T3U747">SeqFinAB</span>(<span class="var type1" id="S13T1U748">LocMaxAB</span>)</span>-<span class="mxinfo " id="T1:U548"><span class="var type1" id="S14T1U750">MaxValAB</span>/<span class="mxinfo " id="T1:U550">2</span></span></span>)&lt;<span class="mxinfo " id="T1:U551">1</span></span>                       <span class="comment">%if for some reason the final element of the sequency minus the half of its</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">            <span class="mxinfo " id="T1:U552"><span class="var type1" id="S75T1U755">LevDec3</span> = <span class="mxinfo " id="T1:U554">0.1</span></span>;                                         <span class="comment">%length results in a negative value, something went very wrong, and by</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">        <span class="keyword">else</span>                                                       <span class="comment">%default it will be set to 0.7</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">            <span class="mxinfo " id="T1:U555"><span class="var type1" id="S75T1U760">LevDec3</span> = <span class="mxinfo " id="T1:U557"><span class="var type1" id="S20T3U762">InterAB</span>(<span class="mxinfo " id="T1:U559">round(<span class="mxinfo " id="T1:U560"><span class="mxinfo " id="T1:U561"><span class="var type1" id="S15T3U767">SeqFinAB</span>(<span class="var type1" id="S13T1U768">LocMaxAB</span>)</span>-<span class="mxinfo " id="T1:U564"><span class="var type1" id="S14T1U770">MaxValAB</span>/<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line">                <span class="mxinfo " id="T1:U566">2</span></span></span>)</span>)</span></span>;<span class="comment">%Otherwise, the decission level is the middle of the sequency</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line">    [<span class="var type1" id="S16T1U775">QMaxValAB</span>,<span class="var type1" id="S17T1U776">QLocMaxAB</span>]=max(<span class="var type1" id="S71T3U779">QSeqOnesAB</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line">    <span class="mxinfo " id="T7:U570"><span class="keyword">if</span> <span class="mxinfo " id="T7:U571"><span class="mxinfo " id="T7:U572"><span class="var type1" id="S17T1U784">QLocMaxAB</span>&lt;<span class="mxinfo " id="T1:U574">2</span></span> || <span class="mxinfo " id="T7:U575"><span class="var type1" id="S16T1U787">QMaxValAB</span>&lt;<span class="mxinfo " id="T1:U577">2</span></span></span>                                    <span class="comment">%if any sequency was found or there is just one sequency it is a error thus</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line">        <span class="mxinfo " id="T1:U578"><span class="var type1" id="S76T1U791">QLevDec3</span> = <span class="mxinfo " id="T1:U580">0.1</span></span>;                                            <span class="comment">%the decission level will be by default 0.67. Also, the other variables will</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line">        <span class="mxinfo " id="T1:U581"><span class="var type1" id="S17T1U795">QLocMaxAB</span> = <span class="mxinfo " id="T1:U583">1</span></span>;                                              <span class="comment">%will be set with values to not cause errors in the future</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line">        <span class="mxinfo " id="T1:U584"><span class="mxinfo " id="T1:U585"><span class="var type1" id="S18T3U800">QSeqFinAB</span>(<span class="mxinfo " id="T1:U587">1</span>)</span>=<span class="mxinfo " id="T1:U588">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line">        <span class="mxinfo " id="T1:U589"><span class="var type1" id="S16T1U805">QMaxValAB</span> = <span class="mxinfo " id="T1:U591">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">        <span class="mxinfo " id="T1:U592"><span class="mxinfo " id="T1:U593"><span class="var type1" id="S19T3U810">QInterAB</span>(<span class="mxinfo " id="T1:U595">1</span>)</span>=<span class="var type1" id="S76T1U812">QLevDec3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line">    <span class="keyword">else</span>                                                           <span class="comment">%if a sequency was found the middle of the eye will be the middle of the sequency</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U597">(<span class="mxinfo " id="T1:U598"><span class="mxinfo " id="T1:U599"><span class="var type1" id="S18T3U820">QSeqFinAB</span>(<span class="var type1" id="S17T1U821">QLocMaxAB</span>)</span>-<span class="mxinfo " id="T1:U602"><span class="var type1" id="S16T1U823">QMaxValAB</span>/<span class="mxinfo " id="T1:U604">2</span></span></span>)&lt;<span class="mxinfo " id="T1:U605">1</span></span>                       <span class="comment">%if for some reason the final element of the sequency minus the half of its</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line">            <span class="mxinfo " id="T1:U606"><span class="var type1" id="S76T1U828">QLevDec3</span> = <span class="mxinfo " id="T1:U608">0.1</span></span>;                                         <span class="comment">%length results in a negative value, something went very wrong, and by</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line">        <span class="keyword">else</span>                                                       <span class="comment">%default it will be set to 0.7</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line">            <span class="mxinfo " id="T1:U609"><span class="var type1" id="S76T1U833">QLevDec3</span> = <span class="mxinfo " id="T1:U611"><span class="var type1" id="S19T3U835">QInterAB</span>(<span class="mxinfo " id="T1:U613">round(<span class="mxinfo " id="T1:U614"><span class="mxinfo " id="T1:U615"><span class="var type1" id="S18T3U840">QSeqFinAB</span>(<span class="var type1" id="S17T1U841">QLocMaxAB</span>)</span>-<span class="mxinfo " id="T1:U618"><span class="var type1" id="S16T1U843">QMaxValAB</span>/<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line">                <span class="mxinfo " id="T1:U620">2</span></span></span>)</span>)</span></span>;<span class="comment">%Otherwise, the decission level is the middle of the sequency</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line">    <span class="comment">%another way to measure the eye opening is the get all the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line">    <span class="comment">%boxes and find all peaks on it, that will be a plato created</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line">    <span class="comment">%by the sequences of ones (which was zeros). From thos peaks,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line">    <span class="comment">%the eye diagram will be the longer of them hence it will take</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231">231</a></span><span class="line">    <span class="comment">%the most part of the vector that store the findpeaks result.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232">232</a></span><span class="line">    <span class="comment">%Thus, the middle of the eye will be basically the middle of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233">233</a></span><span class="line">    <span class="comment">%the peaks vector.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,234" id="srcline234">234</a></span><span class="line">    <span class="mxinfo " id="T8:U621"><span class="var type1" id="S77T8U847">LocAB</span> = <span class="mxinfo " id="T8:U623">find(<span class="var type1" id="S64T6U850">EyeAB</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,235" id="srcline235">235</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U625">~<span class="mxinfo " id="T7:U626">any(<span class="var type1" id="S77T8U856">LocAB</span>)</span></span>                                              <span class="comment">%if for some reason there are no peaks, something went wrong.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,236" id="srcline236">236</a></span><span class="line">        <span class="comment">%LocAB = 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,237" id="srcline237">237</a></span><span class="line">        <span class="mxinfo " id="T1:U628"><span class="var type1" id="S80T1U859">LevelDec3</span> = <span class="mxinfo " id="T1:U630">0.1</span></span>;<span class="comment">%mean(Levels(3:4));                       %by default the decission level will be set to 0.65</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,238" id="srcline238">238</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,239" id="srcline239">239</a></span><span class="line">        <span class="mxinfo " id="T1:U631"><span class="var type1" id="S80T1U864">LevelDec3</span> = <span class="var type1" id="S75T1U865">LevDec3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,240" id="srcline240">240</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,241" id="srcline241">241</a></span><span class="line">    <span class="mxinfo " id="T8:U634"><span class="var type1" id="S81T8U868">QLocAB</span> = <span class="mxinfo " id="T8:U636">find(<span class="var type1" id="S66T6U871">QEyeAB</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,242" id="srcline242">242</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U638">~<span class="mxinfo " id="T7:U639">any(<span class="var type1" id="S81T8U877">QLocAB</span>)</span></span>                                              <span class="comment">%if for some reason there are no peaks, something went wrong.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,243" id="srcline243">243</a></span><span class="line">        <span class="comment">%QLocAB = 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,244" id="srcline244">244</a></span><span class="line">        <span class="mxinfo " id="T1:U641"><span class="var type1" id="S82T1U880">QLevelDec3</span> = <span class="mxinfo " id="T1:U643">0.1</span></span>;<span class="comment">%mean(Levels(3:4));                       %by default the decission level will be set to 0.65</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,245" id="srcline245">245</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,246" id="srcline246">246</a></span><span class="line">        <span class="mxinfo " id="T1:U644"><span class="var type1" id="S82T1U885">QLevelDec3</span> = <span class="var type1" id="S76T1U886">QLevDec3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,247" id="srcline247">247</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,248" id="srcline248">248</a></span><span class="line">    <span class="comment">%##########################################################################</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,249" id="srcline249">249</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,250" id="srcline250">250</a></span><span class="line">    <span class="mxinfo " id="T1:U647"><span class="var type1" id="S2T1U889">AberLevI</span> = <span class="mxinfo " id="T1:U649"><span class="mxinfo " id="T1:U650"><span class="var type1" id="S20T3U892">InterAB</span>(<span class="mxinfo " id="T1:U652"><span class="var type1" id="S15T3U894">SeqFinAB</span>(<span class="var type1" id="S13T1U895">LocMaxAB</span>)</span>)</span>-<span class="mxinfo " id="T1:U655"><span class="var type1" id="S20T3U897">InterAB</span>(<span class="mxinfo " id="T1:U657">round(<span class="mxinfo " id="T1:U658"><span class="mxinfo " id="T1:U659"><span class="var type1" id="S15T3U902">SeqFinAB</span>(<span class="var type1" id="S13T1U903">LocMaxAB</span>)</span>-<span class="var type1" id="S14T1U904">MaxValAB</span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,251" id="srcline251">251</a></span><span class="line">    <span class="mxinfo " id="T1:U663"><span class="var type1" id="S3T1U907">ValsLevI</span> = <span class="var type1" id="S75T1U908">LevDec3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,252" id="srcline252">252</a></span><span class="line">    <span class="mxinfo " id="T1:U666"><span class="var type1" id="S4T1U911">AberLevQ</span> = <span class="mxinfo " id="T1:U668"><span class="mxinfo " id="T1:U669"><span class="var type1" id="S19T3U914">QInterAB</span>(<span class="mxinfo " id="T1:U671"><span class="var type1" id="S18T3U916">QSeqFinAB</span>(<span class="var type1" id="S17T1U917">QLocMaxAB</span>)</span>)</span>-<span class="mxinfo " id="T1:U674"><span class="var type1" id="S19T3U919">QInterAB</span>(<span class="mxinfo " id="T1:U676">round(<span class="mxinfo " id="T1:U677"><span class="mxinfo " id="T1:U678"><span class="var type1" id="S18T3U924">QSeqFinAB</span>(<span class="var type1" id="S17T1U925">QLocMaxAB</span>)</span>-<span class="var type1" id="S16T1U926">QMaxValAB</span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,253" id="srcline253">253</a></span><span class="line">    <span class="mxinfo " id="T1:U682"><span class="var type1" id="S5T1U929">ValsLevQ</span> = <span class="var type1" id="S76T1U930">QLevDec3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,254" id="srcline254">254</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255">255</a></span><span class="line">    <span class="comment">%% Ploting the result for qualitative analizes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256">256</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257">257</a></span><span class="line">    <span class="comment">%if ThisCarr==126</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258">258</a></span><span class="line">    <span class="comment">%EyeToPlot(CurrentTest,1:length([EoutI EoutQ])) = [EoutI EoutQ];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259">259</a></span><span class="line">    <span class="comment">%save(['savingforplotingeye' num2str(VetSnr)],'EyeToPlot','VetSnr','IfftOrSum','UsedModula','T','NPPB');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260">260</a></span><span class="line">    <span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261">261</a></span><span class="line">    <span class="mxinfo " id="T2:U685"><span class="var type1" id="S83T2U933">TxDataOddA</span> = <span class="mxinfo " id="T2:U687"><span class="var type1" id="S37T4U935">TxDataMat</span>(<span class="var type1" id="S38T1U936">ThisCarr</span>,<span class="mxinfo " id="T5:U690">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,262" id="srcline262">262</a></span><span class="line">    <span class="mxinfo " id="T4:U691"><span class="var type1" id="S84T4U940">TxDataOddB</span> = <span class="mxinfo " id="T4:U693">reshape(<span class="var type1" id="S83T2U943">TxDataOddA</span>,<span class="mxinfo " id="T1:U695"><span class="var type1" id="S32T1U945">NbDQPSK</span>/<span class="mxinfo " id="T1:U697">2</span></span>,<span class="var type1" id="S33T1U947">CurTesSiz</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,263" id="srcline263">263</a></span><span class="line">    <span class="mxinfo " id="T4:U699"><span class="var type1" id="S85T4U950">TxDataOddC</span> = <span class="mxinfo " id="T4:U701"><span class="var type1" id="S84T4U952">TxDataOddB</span>(<span class="mxinfo " id="T2:U703"><span class="mxinfo " id="T1:U704"><span class="mxinfo " id="T1:U705">1</span>+<span class="var type1" id="S36T1U956">SyncPeriod</span></span>:<span class="mxinfo " id="T1:U707"><span class="mxinfo " id="T1:U708">end</span>-<span class="var type1" id="S36T1U960">SyncPeriod</span></span></span>,<span class="mxinfo " id="T5:U710">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,264" id="srcline264">264</a></span><span class="line">    <span class="mxinfo " id="T2:U711"><span class="var type1" id="S9T2U964">TxDataOdd</span>  = <span class="mxinfo " id="T2:U713">reshape(<span class="var type1" id="S85T4U967">TxDataOddC</span>,1,<span class="mxinfo " id="T1:U715"><span class="mxinfo " id="T1:U716">size(<span class="var type1" id="S85T4U972">TxDataOddC</span>,1)</span>*<span class="mxinfo " id="T1:U718">size(<span class="var type1" id="S85T4U976">TxDataOddC</span>,2)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,265" id="srcline265">265</a></span><span class="line">    <span class="mxinfo " id="T2:U720"><span class="var type1" id="S86T2U980">TxDataEvenA</span> = <span class="mxinfo " id="T2:U722"><span class="var type1" id="S37T4U982">TxDataMat</span>(<span class="mxinfo " id="T1:U724"><span class="var type1" id="S38T1U984">ThisCarr</span>+<span class="var type1" id="S41T1U985">NumCarr</span></span>,<span class="mxinfo " id="T5:U727">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266">266</a></span><span class="line">    <span class="mxinfo " id="T4:U728"><span class="var type1" id="S87T4U989">TxDataEvenB</span> = <span class="mxinfo " id="T4:U730">reshape(<span class="var type1" id="S86T2U992">TxDataEvenA</span>,<span class="mxinfo " id="T1:U732"><span class="var type1" id="S32T1U994">NbDQPSK</span>/<span class="mxinfo " id="T1:U734">2</span></span>,<span class="var type1" id="S33T1U996">CurTesSiz</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267">267</a></span><span class="line">    <span class="mxinfo " id="T4:U736"><span class="var type1" id="S88T4U999">TxDataEvenC</span> = <span class="mxinfo " id="T4:U738"><span class="var type1" id="S87T4U1001">TxDataEvenB</span>(<span class="mxinfo " id="T2:U740"><span class="mxinfo " id="T1:U741"><span class="mxinfo " id="T1:U742">1</span>+<span class="var type1" id="S36T1U1005">SyncPeriod</span></span>:<span class="mxinfo " id="T1:U744"><span class="mxinfo " id="T1:U745">end</span>-<span class="var type1" id="S36T1U1009">SyncPeriod</span></span></span>,<span class="mxinfo " id="T5:U747">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268">268</a></span><span class="line">    <span class="mxinfo " id="T2:U748"><span class="var type1" id="S10T2U1013">TxDataEven</span>  = <span class="mxinfo " id="T2:U750">reshape(<span class="var type1" id="S88T4U1016">TxDataEvenC</span>,1,<span class="mxinfo " id="T1:U752"><span class="mxinfo " id="T1:U753">size(<span class="var type1" id="S88T4U1021">TxDataEvenC</span>,1)</span>*<span class="mxinfo " id="T1:U755">size(<span class="var type1" id="S88T4U1025">TxDataEvenC</span>,2)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,269" id="srcline269">269</a></span><span class="line">    <span class="comment">%%  Ploting some results for qualitative analizes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,270" id="srcline270">270</a></span><span class="line">    <span class="comment">%             PrintInfo(Ploting*28,t(1:length(EoutI)),Txaux1,Txaux2,EoutI,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,271" id="srcline271">271</a></span><span class="line">    <span class="comment">%                           EoutA,EoutB,EoutQ,EoutC,EoutD,real(Ui),real(Uq));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,272" id="srcline272">272</a></span><span class="line">    <span class="comment">%                       a=1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,273" id="srcline273">273</a></span><span class="line">    <span class="comment">%%               Recovering the Information</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,274" id="srcline274">274</a></span><span class="line">    <span class="comment">%After passing the optical signal to the eletrical domain, for</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,275" id="srcline275">275</a></span><span class="line">    <span class="comment">%actually detect the data withing the signal the following</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,276" id="srcline276">276</a></span><span class="line">    <span class="comment">%steps are needed.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,277" id="srcline277">277</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,278" id="srcline278">278</a></span><span class="line">    <span class="comment">%Finding Decission Levels:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,279" id="srcline279">279</a></span><span class="line">    <span class="comment">%The process for decoding the income signal will be based on</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,280" id="srcline280">280</a></span><span class="line">    <span class="comment">%eletronic comparators. Inasmuch as the right decission level</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,281" id="srcline281">281</a></span><span class="line">    <span class="comment">%must be acquired for accurately decide, within a symbol</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,282" id="srcline282">282</a></span><span class="line">    <span class="comment">%periode, what that current leavel means (ones or zeros).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,283" id="srcline283">283</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,284" id="srcline284">284</a></span><span class="line">    <span class="comment">%The process hereafter of chosing the  decission levels is not</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,285" id="srcline285">285</a></span><span class="line">    <span class="comment">%deterministic rather it is a statistic process. The main idea</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,286" id="srcline286">286</a></span><span class="line">    <span class="comment">%is to take the decission level from the histogram generated</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,287" id="srcline287">287</a></span><span class="line">    <span class="comment">%from the income signal stream.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,288" id="srcline288">288</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,289" id="srcline289">289</a></span><span class="line">    <span class="comment">%This process is realized inside the function Olho_mex.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,290" id="srcline290">290</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,291" id="srcline291">291</a></span><span class="line">    <span class="comment">%Basicaly the decission level will be the minimal value of the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,292" id="srcline292">292</a></span><span class="line">    <span class="comment">%currente eye under evaluation plus the half of the its eye</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,293" id="srcline293">293</a></span><span class="line">    <span class="comment">%opening.The following ilustration better describe this process</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,294" id="srcline294">294</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295">295</a></span><span class="line">    <span class="comment">%Eye Limits:   + (1/2 * Eye Opening:)  =    Comparisson Limit:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296">296</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,297" id="srcline297">297</a></span><span class="line">    <span class="comment">%UperLevel  ______     ______________     _____</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,298" id="srcline298">298</a></span><span class="line">    <span class="comment">%                 \   /      |       \   /</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,299" id="srcline299">299</a></span><span class="line">    <span class="comment">%                  \ /       |        \ /</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,300" id="srcline300">300</a></span><span class="line">    <span class="comment">%                   \ Half Eye Opening /     Decission Level</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line">    <span class="comment">%                  / \       |        / \</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line">    <span class="comment">%LowerLevel ______/   \______|_______/   \_____</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line">    <span class="comment">%Actualy Receiving Data:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line">    <span class="comment">%Once the signal was processed the next step is through a</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line">    <span class="comment">%comparator decide the actual information received.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line">    <span class="mxinfo " id="T2:U757"><span class="var type1" id="S89T2U1029">ThisDataSize</span> = <span class="mxinfo " id="T2:U759"><span class="mxinfo " id="T1:U760"><span class="var type1" id="S35T1U1033">NPPB</span>/<span class="mxinfo " id="T1:U762">2</span></span>:<span class="var type1" id="S35T1U1035">NPPB</span>:<span class="mxinfo " id="T1:U764">length(<span class="var type1" id="S7T2U1038">EoutI</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311">311</a></span><span class="line">    <span class="comment">%ThisDataPos  = 1:NPPB:length(EoutI);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312">312</a></span><span class="line">    <span class="mxinfo " id="T2:U766"><span class="var type1" id="S11T2U1041">DataOdd</span> = <span class="mxinfo " id="T2:U768">zeros(<span class="mxinfo " id="T1:U769">1</span>,<span class="mxinfo " id="T1:U770">length(<span class="var type1" id="S89T2U1047">ThisDataSize</span>)</span>)</span></span>;                                                  <span class="comment">%Initialization of the vector that will store the income data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313">313</a></span><span class="line">    <span class="mxinfo " id="T2:U772"><span class="var type1" id="S90T2U1050">DataOddU</span> = <span class="mxinfo " id="T2:U774">zeros(<span class="mxinfo " id="T1:U775">1</span>,<span class="mxinfo " id="T1:U776">length(<span class="var type1" id="S89T2U1056">ThisDataSize</span>)</span>)</span></span>;                                                  <span class="comment">%Initialization of the vector that will store the income data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314">314</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S74T1U1059">kk</span>=<span class="mxinfo " id="T1:U779">1</span>:length(<span class="var type1" id="S89T2U1064">ThisDataSize</span>)<span class="comment">%length(EoutI(ThisDataSize))                                    %The comparison process will be made for each symbol period</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315">315</a></span><span class="line">        <span class="comment">%MeanOfData = mean(EoutI((kk-1)+SymLocI(1)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316">316</a></span><span class="line">        <span class="mxinfo " id="T1:U781"><span class="var type1" id="S91T1U1067">MeanOfData</span> = <span class="mxinfo " id="T1:U783">mean(<span class="mxinfo " id="T1:U784"><span class="var type1" id="S7T2U1071">EoutI</span>(<span class="mxinfo " id="T1:U786"><span class="mxinfo " id="T1:U787">(<span class="mxinfo " id="T1:U788"><span class="var type1" id="S74T1U1076">kk</span>-<span class="mxinfo " id="T1:U790">1</span></span>)*<span class="var type1" id="S35T1U1078">NPPB</span></span>+<span class="mxinfo " id="T1:U792"><span class="var type1" id="S35T1U1080">NPPB</span>/<span class="mxinfo " id="T1:U794">2</span></span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317">317</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U795"><span class="var type1" id="S91T1U1085">MeanOfData</span> &gt; <span class="var type1" id="S80T1U1086">LevelDec3</span></span><span class="comment">%EyeOpenLowI+EyeOpenI/2                     %If it is the uper level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318">318</a></span><span class="line">            <span class="mxinfo " id="T1:U798"><span class="mxinfo " id="T1:U799"><span class="var type1" id="S11T2U1090">DataOdd</span>(<span class="var type1" id="S74T1U1091">kk</span>)</span> = <span class="mxinfo " id="T1:U802">1</span></span>;                                 <span class="comment">%is 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319">319</a></span><span class="line">        <span class="keyword">else</span>                                                       <span class="comment">%If it is the lowest level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line">            <span class="mxinfo " id="T1:U803"><span class="mxinfo " id="T1:U804"><span class="var type1" id="S11T2U1097">DataOdd</span>(<span class="var type1" id="S74T1U1098">kk</span>)</span> = <span class="mxinfo " id="T1:U807">0</span></span>;                                 <span class="comment">%is 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line">        <span class="comment">%MeanOfData = mean(EoutI((kk-1)*NPPB+(NPPB/2)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,323" id="srcline323">323</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U808"><span class="var type1" id="S91T1U1103">MeanOfData</span> &gt; <span class="var type1" id="S39T1U1104">LevDefDpqsk</span></span><span class="comment">%EyeOpenLowI+EyeOpenI/2                     %If it is the uper level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,324" id="srcline324">324</a></span><span class="line">            <span class="mxinfo " id="T1:U811"><span class="mxinfo " id="T1:U812"><span class="var type1" id="S90T2U1108">DataOddU</span>(<span class="var type1" id="S74T1U1109">kk</span>)</span> = <span class="mxinfo " id="T1:U815">1</span></span>;                                 <span class="comment">%is 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,325" id="srcline325">325</a></span><span class="line">        <span class="keyword">else</span>                                                       <span class="comment">%If it is the lowest level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,326" id="srcline326">326</a></span><span class="line">            <span class="mxinfo " id="T1:U816"><span class="mxinfo " id="T1:U817"><span class="var type1" id="S90T2U1115">DataOddU</span>(<span class="var type1" id="S74T1U1116">kk</span>)</span> = <span class="mxinfo " id="T1:U820">0</span></span>;                                 <span class="comment">%is 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,327" id="srcline327">327</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,328" id="srcline328">328</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,329" id="srcline329">329</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,330" id="srcline330">330</a></span><span class="line">    <span class="comment">%The identical process just described above will also be used</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,331" id="srcline331">331</a></span><span class="line">    <span class="comment">%to recover the data at the even positions.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,332" id="srcline332">332</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,333" id="srcline333">333</a></span><span class="line">    <span class="comment">%As this process is also statistical, first we reshape the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,334" id="srcline334">334</a></span><span class="line">    <span class="comment">%income vector to analyze all periods at the same time.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,335" id="srcline335">335</a></span><span class="line">    <span class="comment">%                 EyeSymMatQ = reshape(EoutQ(1+SyncPeriod*NPPB:end-SyncPeriod*<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,336" id="srcline336">336</a></span><span class="line">    <span class="comment">%                     NPPB),NPPB,NbDQPSK/2-2*SyncPeriod);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,337" id="srcline337">337</a></span><span class="line">    <span class="comment">%                 %Then we take the values that compose the decision level</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,338" id="srcline338">338</a></span><span class="line">    <span class="comment">%                 %because they will mark the point of symmetry.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,339" id="srcline339">339</a></span><span class="line">    <span class="comment">%                 %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,340" id="srcline340">340</a></span><span class="line">    <span class="comment">%                 %Firstly it was set the interval in which the histogram will be</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,341" id="srcline341">341</a></span><span class="line">    <span class="comment">%                 %build. It is based on the number of samples per bit period.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,342" id="srcline342">342</a></span><span class="line">    <span class="comment">%                 IntervalQ = linspace(min(EoutQ(1+SyncPeriod*NPPB:end-<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,343" id="srcline343">343</a></span><span class="line">    <span class="comment">%                     SyncPeriod*NPPB)),max(EoutQ(1+SyncPeriod*NPPB:end-<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,344" id="srcline344">344</a></span><span class="line">    <span class="comment">%                     SyncPeriod*NPPB)),2*NPPB);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,345" id="srcline345">345</a></span><span class="line">    <span class="comment">%                 %Therefore, the MATLAB hist function returns the number of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,346" id="srcline346">346</a></span><span class="line">    <span class="comment">%                 %occurrence of each interval.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,347" id="srcline347">347</a></span><span class="line">    <span class="comment">%                 EyeMaxQ = hist(EoutQ,IntervalQ);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,348" id="srcline348">348</a></span><span class="line">    <span class="comment">%                 EyeMaxauxQ = [0 EyeMaxI 0];                                    %Zeros are added at the EyeMax to auxiliate the finding peaks process</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,349" id="srcline349">349</a></span><span class="line">    <span class="comment">%                 [~,EyeLocQ] = findpeaks(EyeMaxauxQ,'MinPeakDistance',NPPB/4,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,350" id="srcline350">350</a></span><span class="line">    <span class="comment">%                     'SortStr','descend','NPeaks',2);%The peaks on the Eye profile will be the levels at the Eyes limit</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,351" id="srcline351">351</a></span><span class="line">    <span class="comment">%                 ValToSeekQ = IntervalQ(EyeLocQ-1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,352" id="srcline352">352</a></span><span class="line">    <span class="comment">%                 ValToSeekQ = sort(ValToSeekQ,'ascend');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,353" id="srcline353">353</a></span><span class="line">    <span class="comment">%                 OccuCountQ = zeros(1,size(EyeSymMatQ,1));                      %Auxiliar Variable for accounting.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,354" id="srcline354">354</a></span><span class="line">    <span class="comment">%                 for kk=1:size(EyeSymMatQ,1)                                    %For every sample within a symbol period</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,355" id="srcline355">355</a></span><span class="line">    <span class="comment">%                     OccuCountQ(kk) = OccuCountQ(kk)+sum((EyeSymMatI(kk,:)&gt;=<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,356" id="srcline356">356</a></span><span class="line">    <span class="comment">%                         LowSymPer*ValToSeekQ(1))&amp;(EyeSymMatQ(kk,:)&lt;=UpeSymPer*<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,357" id="srcline357">357</a></span><span class="line">    <span class="comment">%                         ValToSeekQ(1)));%Account all occurencies of the valeu 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,358" id="srcline358">358</a></span><span class="line">    <span class="comment">%                     OccuCountQ(kk) = OccuCountQ(kk)+sum((EyeSymMatQ(kk,:)&gt;=<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,359" id="srcline359">359</a></span><span class="line">    <span class="comment">%                         LowSymPer*ValToSeekQ(2))&amp;(EyeSymMatQ(kk,:)&lt;=UpeSymPer*<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,360" id="srcline360">360</a></span><span class="line">    <span class="comment">%                         ValToSeekQ(2)));%Account all occurencies of the valeu 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,361" id="srcline361">361</a></span><span class="line">    <span class="comment">%                 end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,362" id="srcline362">362</a></span><span class="line">    <span class="comment">%                 %             [~,SymLocQ] = findpeaks(OccuCountQ,'SortStr','descend');       %The peak on the Eye profile will be the Symmetry level</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,363" id="srcline363">363</a></span><span class="line">    <span class="comment">%                 [SymLocQ] = round(mean(find(ismember(OccuCountQ,max(<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,364" id="srcline364">364</a></span><span class="line">    <span class="comment">%                     OccuCountQ)))));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,365" id="srcline365">365</a></span><span class="line">    <span class="comment">%##############################################################</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,366" id="srcline366">366</a></span><span class="line">    <span class="comment">%######################Important###############################</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,367" id="srcline367">367</a></span><span class="line">    <span class="comment">%The ber results for the Data Even is not as good as the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,368" id="srcline368">368</a></span><span class="line">    <span class="comment">%results of the Data Odd. One possible reason is the decision</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,369" id="srcline369">369</a></span><span class="line">    <span class="comment">%point of symmetry hence, for testing, we change SymLocQ to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,370" id="srcline370">370</a></span><span class="line">    <span class="comment">%SymLocI for evaluation of improvement. It is expected as bouth</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,371" id="srcline371">371</a></span><span class="line">    <span class="comment">%signal will the same point of symetry will perform in an equal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,372" id="srcline372">372</a></span><span class="line">    <span class="comment">%way. If it is confirmed the creation of SymLocQ will be</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,373" id="srcline373">373</a></span><span class="line">    <span class="comment">%erased.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,374" id="srcline374">374</a></span><span class="line">    <span class="comment">%##############################################################</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,375" id="srcline375">375</a></span><span class="line">    <span class="comment">%##############################################################</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,376" id="srcline376">376</a></span><span class="line">    <span class="mxinfo " id="T2:U821"><span class="var type1" id="S89T2U1120">ThisDataSize</span> = <span class="mxinfo " id="T2:U823"><span class="mxinfo " id="T1:U824"><span class="var type1" id="S35T1U1124">NPPB</span>/<span class="mxinfo " id="T1:U826">2</span></span>:<span class="var type1" id="S35T1U1126">NPPB</span>:<span class="mxinfo " id="T1:U828">length(<span class="var type1" id="S8T2U1129">EoutQ</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,377" id="srcline377">377</a></span><span class="line">    <span class="comment">%ThisDataPos  = 1:NPPB:length(EoutQ);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,378" id="srcline378">378</a></span><span class="line">    <span class="mxinfo " id="T2:U830"><span class="var type1" id="S12T2U1132">DataEven</span> = <span class="mxinfo " id="T2:U832">zeros(<span class="mxinfo " id="T1:U833">1</span>,<span class="mxinfo " id="T1:U834">length(<span class="var type1" id="S89T2U1138">ThisDataSize</span>)</span>)</span></span>;                                                 <span class="comment">%Initialization of the vector that will store the income data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,379" id="srcline379">379</a></span><span class="line">    <span class="mxinfo " id="T2:U836"><span class="var type1" id="S92T2U1141">DataEvenU</span> = <span class="mxinfo " id="T2:U838">zeros(<span class="mxinfo " id="T1:U839">1</span>,<span class="mxinfo " id="T1:U840">length(<span class="var type1" id="S89T2U1147">ThisDataSize</span>)</span>)</span></span>;                                                 <span class="comment">%Initialization of the vector that will store the income data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,380" id="srcline380">380</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S74T1U1150">kk</span>=<span class="mxinfo " id="T1:U843">1</span>:length(<span class="var type1" id="S89T2U1155">ThisDataSize</span>)<span class="comment">%length(EoutQ(ThisDataSize))                                    %The comparison process will be made for each symbol period</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,381" id="srcline381">381</a></span><span class="line">        <span class="comment">%                 MeanOfData = mean(EoutQ((kk-1)+SymLocI(1)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,382" id="srcline382">382</a></span><span class="line">        <span class="mxinfo " id="T1:U845"><span class="var type1" id="S91T1U1158">MeanOfData</span> = <span class="mxinfo " id="T1:U847">mean(<span class="mxinfo " id="T1:U848"><span class="var type1" id="S8T2U1162">EoutQ</span>(<span class="mxinfo " id="T1:U850"><span class="mxinfo " id="T1:U851">(<span class="mxinfo " id="T1:U852"><span class="var type1" id="S74T1U1167">kk</span>-<span class="mxinfo " id="T1:U854">1</span></span>)*<span class="var type1" id="S35T1U1169">NPPB</span></span>+<span class="mxinfo " id="T1:U856"><span class="var type1" id="S35T1U1171">NPPB</span>/<span class="mxinfo " id="T1:U858">2</span></span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,383" id="srcline383">383</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U859"><span class="var type1" id="S91T1U1176">MeanOfData</span> &gt; <span class="var type1" id="S82T1U1177">QLevelDec3</span></span><span class="comment">%EyeOpenLowQ+EyeOpenQ/2                     %If it is the uper level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,384" id="srcline384">384</a></span><span class="line">            <span class="mxinfo " id="T1:U862"><span class="mxinfo " id="T1:U863"><span class="var type1" id="S12T2U1181">DataEven</span>(<span class="var type1" id="S74T1U1182">kk</span>)</span> = <span class="mxinfo " id="T1:U866">1</span></span>;                               <span class="comment">%is 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,385" id="srcline385">385</a></span><span class="line">        <span class="keyword">else</span>                                                       <span class="comment">%If it is the lowest level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,386" id="srcline386">386</a></span><span class="line">            <span class="mxinfo " id="T1:U867"><span class="mxinfo " id="T1:U868"><span class="var type1" id="S12T2U1188">DataEven</span>(<span class="var type1" id="S74T1U1189">kk</span>)</span> = <span class="mxinfo " id="T1:U871">0</span></span>;                               <span class="comment">%is 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,387" id="srcline387">387</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,388" id="srcline388">388</a></span><span class="line">        <span class="comment">%MeanOfData = mean(EoutQ((kk-1)*NPPB+(NPPB/2)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,389" id="srcline389">389</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U872"><span class="var type1" id="S91T1U1194">MeanOfData</span> &gt; <span class="var type1" id="S39T1U1195">LevDefDpqsk</span></span><span class="comment">%EyeOpenLowI+EyeOpenI/2                     %If it is the uper level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,390" id="srcline390">390</a></span><span class="line">            <span class="mxinfo " id="T1:U875"><span class="mxinfo " id="T1:U876"><span class="var type1" id="S92T2U1199">DataEvenU</span>(<span class="var type1" id="S74T1U1200">kk</span>)</span> = <span class="mxinfo " id="T1:U879">1</span></span>;                                 <span class="comment">%is 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,391" id="srcline391">391</a></span><span class="line">        <span class="keyword">else</span>                                                       <span class="comment">%If it is the lowest level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,392" id="srcline392">392</a></span><span class="line">            <span class="mxinfo " id="T1:U880"><span class="mxinfo " id="T1:U881"><span class="var type1" id="S92T2U1206">DataEvenU</span>(<span class="var type1" id="S74T1U1207">kk</span>)</span> = <span class="mxinfo " id="T1:U884">0</span></span>;                                 <span class="comment">%is 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,393" id="srcline393">393</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,394" id="srcline394">394</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,395" id="srcline395">395</a></span><span class="line">    <span class="comment">%%       Calculating the Bit Error Ratio (BER)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,396" id="srcline396">396</a></span><span class="line">    <span class="comment">%The final process here is to count the number of wrongdoings</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,397" id="srcline397">397</a></span><span class="line">    <span class="comment">%of this whole process upon the transmited data for</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,398" id="srcline398">398</a></span><span class="line">    <span class="comment">%quantitative analizes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,399" id="srcline399">399</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,400" id="srcline400">400</a></span><span class="line">    <span class="mxinfo " id="T1:U885"><span class="var type1" id="S93T1U1211">BitErrOdd1</span>  = <span class="mxinfo " id="T1:U887">sum(<span class="mxinfo " id="T9:U888">xor(<span class="var type1" id="S9T2U1216">TxDataOdd</span>,<span class="var type1" id="S11T2U1217">DataOdd</span>)</span>)</span></span>;                      <span class="comment">%Comparison between the Transmited and received and counting the differences</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,401" id="srcline401">401</a></span><span class="line">    <span class="mxinfo " id="T1:U891"><span class="var type1" id="S96T1U1220">BitErrEven1</span> = <span class="mxinfo " id="T1:U893">sum(<span class="mxinfo " id="T9:U894">xor(<span class="var type1" id="S10T2U1225">TxDataEven</span>,<span class="var type1" id="S12T2U1226">DataEven</span>)</span>)</span></span>;                    <span class="comment">%Comparison between the Transmited and received and counting the differences</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,402" id="srcline402">402</a></span><span class="line">    <span class="mxinfo " id="T1:U897"><span class="var type1" id="S97T1U1229">BitErrOdd4</span>  = <span class="mxinfo " id="T1:U899">sum(<span class="mxinfo " id="T9:U900">xor(<span class="var type1" id="S9T2U1234">TxDataOdd</span>,<span class="var type1" id="S90T2U1235">DataOddU</span>)</span>)</span></span>;                      <span class="comment">%Comparison between the Transmited and received and counting the differences</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,403" id="srcline403">403</a></span><span class="line">    <span class="mxinfo " id="T1:U903"><span class="var type1" id="S98T1U1238">BitErrEven4</span> = <span class="mxinfo " id="T1:U905">sum(<span class="mxinfo " id="T9:U906">xor(<span class="var type1" id="S10T2U1243">TxDataEven</span>,<span class="var type1" id="S92T2U1244">DataEvenU</span>)</span>)</span></span>;                    <span class="comment">%Comparison between the Transmited and received and counting the differences</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,404" id="srcline404">404</a></span><span class="line">    <span class="mxinfo " id="T1:U909"><span class="var type1" id="S6T1U1247">BerDQPSK</span> = <span class="mxinfo " id="T1:U911">(<span class="mxinfo " id="T1:U912"><span class="var type1" id="S93T1U1251">BitErrOdd1</span>+<span class="var type1" id="S96T1U1252">BitErrEven1</span></span>)/(<span class="mxinfo " id="T1:U915">(<span class="mxinfo " id="T1:U916">(<span class="var type1" id="S32T1U1258">NbDQPSK</span>)-(<span class="mxinfo " id="T1:U918"><span class="mxinfo " id="T1:U919">2</span>*<span class="var type1" id="S36T1U1262">SyncPeriod</span></span>)</span>)*<span class="var type1" id="S33T1U1263">CurTesSiz</span></span>)</span></span>;<span class="comment">%Calculating the ration of wrong bits and the total number of bits transmited</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,405" id="srcline405">405</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U922">(<span class="mxinfo " id="T1:U923"><span class="var type1" id="S97T1U1269">BitErrOdd4</span>+ <span class="var type1" id="S98T1U1270">BitErrEven4</span></span>) &lt; (<span class="mxinfo " id="T1:U926"><span class="var type1" id="S93T1U1273">BitErrOdd1</span>+ <span class="var type1" id="S96T1U1274">BitErrEven1</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,406" id="srcline406">406</a></span><span class="line">        <span class="mxinfo " id="T1:U929"><span class="var type1" id="S6T1U1277">BerDQPSK</span> = <span class="mxinfo " id="T1:U931">(<span class="mxinfo " id="T1:U932"><span class="var type1" id="S97T1U1281">BitErrOdd4</span>+<span class="var type1" id="S98T1U1282">BitErrEven4</span></span>)/(<span class="mxinfo " id="T1:U935">(<span class="mxinfo " id="T1:U936">(<span class="var type1" id="S32T1U1288">NbDQPSK</span>)-(<span class="mxinfo " id="T1:U938"><span class="mxinfo " id="T1:U939">2</span>*<span class="var type1" id="S36T1U1292">SyncPeriod</span></span>)</span>)*<span class="var type1" id="S33T1U1293">CurTesSiz</span></span>)</span></span>;<span class="comment">%Calculating the ration of wrong bits and the total number of bits transmited</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,407" id="srcline407">407</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,408" id="srcline408">408</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,409" id="srcline409">409</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
