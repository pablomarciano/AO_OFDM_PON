<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">LevDec1</span>,<span class="var type1" id="S3T1U4">LevDec2</span>,<span class="var type1" id="S4T1U5">LevDec3</span>,<span class="var type1" id="S5T2U6">Ix</span>,<span class="var type1" id="S6T1U7">Ber4PAM</span>,<span class="var type1" id="S7T1U8">DecLevDef3</span>,<span class="var type1" id="S8T1U9">DecLevDef2</span>,<span class="var type1" id="S9T1U10">DecLevDef1</span>,<span class="var type1" id="S10T2U11">TxData</span>,<span class="var type1" id="S11T2U12">IxRecDef</span>,<span class="var type1" id="S12T2U13">IxRec</span>,<span class="var type1" id="S13T1U14">AberLev1</span>,<span class="var type1" id="S14T1U15">AberLev2</span>,<span class="var type1" id="S15T1U16">AberLev3</span>,<span class="var type1" id="S16T1U17">ValsLev1</span>,<span class="var type1" id="S17T1U18">ValsLev2</span>,<span class="var type1" id="S18T1U19">ValsLev3</span>,<span class="var type1" id="S19T1U20">ValsLev21</span>,<span class="var type1" id="S20T1U21">ValsLev22</span>,<span class="var type1" id="S21T1U22">ValsLev23</span>,<span class="var type1" id="S22T3U23">InterAB</span>,<span class="var type1" id="S23T3U24">InterCD</span>,<span class="var type1" id="S24T3U25">InterEF</span>,<span class="var type1" id="S25T3U26">SeqFinAB</span>,<span class="var type1" id="S26T3U27">SeqFinCD</span>,<span class="var type1" id="S27T3U28">SeqFinEF</span>,<span class="var type1" id="S28T1U29">LocMaxAB</span>,<span class="var type1" id="S29T1U30">LocMaxCD</span>,<span class="var type1" id="S30T1U31">LocMaxEF</span>,<span class="var type1" id="S31T1U32">MaxValAB</span>,<span class="var type1" id="S32T1U33">MaxValCD</span>,<span class="var type1" id="S33T1U34">MaxValEF</span>,<span class="var type1" id="S34T4U35">Levels</span>] = RecDowPam4(<span class="var type1" id="S35T5U38">Ix1</span>,<span class="var type1" id="S36T1U39">T</span>,<span class="var type1" id="S37T1U40">Ta</span>,<span class="var type1" id="S38T1U41">MaxNumStag</span>,<span class="var type1" id="S39T1U42">StuffSampels</span>,<span class="var type1" id="S40T1U43">NumAmosCP</span>,<span class="var type1" id="S41T1U44">NPPB</span>,<span class="var type1" id="S42T1U45">CurTesSiz</span>,<span class="var type1" id="S43T1U46">Nb4Pam</span>,<span class="var type1" id="S44T1U47">IntervalStep</span>,<span class="var type1" id="S45T1U48">MinDist</span>,<span class="var type1" id="S9T1U49">DecLevDef1</span>,<span class="var type1" id="S8T1U50">DecLevDef2</span>,<span class="var type1" id="S7T1U51">DecLevDef3</span>,<span class="var type1" id="S46T5U52">TxDataMat</span>,<span class="var type1" id="S47T1U53">ThisCarr</span>,<span class="var type1" id="S48T1U54">IfftOrSum</span>,<span class="var type1" id="S49T1U55">AddCP</span>,<span class="var type1" id="S50T1U56">SyncPeriod</span>,<span class="var type1" id="S51T1U57">DecMod</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="mxinfo " id="T1:U54"><span class="var type1" id="S52T1U60">sn</span>=<span class="mxinfo " id="T1:U56">(<span class="mxinfo " id="T1:U57">(<span class="mxinfo " id="T1:U58"><span class="mxinfo " id="T1:U59">1</span>/<span class="mxinfo " id="T1:U60">2</span></span>)*(<span class="mxinfo " id="T1:U61">(<span class="mxinfo " id="T1:U62">(<span class="mxinfo " id="T1:U63">1/2</span>)^<span class="var type1" id="S38T1U76">MaxNumStag</span></span>)-<span class="mxinfo " id="T1:U65">1</span></span>)</span>)/(<span class="mxinfo " id="T1:U66">(1/2)-1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="mxinfo " id="T1:U67"><span class="var type1" id="S53T1U87">AuxSyncCorr</span> = <span class="mxinfo " id="T1:U69">round(<span class="mxinfo " id="T1:U70"><span class="mxinfo " id="T1:U71">(<span class="mxinfo " id="T1:U72"><span class="var type1" id="S52T1U94">sn</span>/(<span class="mxinfo " id="T1:U74"><span class="mxinfo " id="T1:U75">2</span>/<span class="mxinfo " id="T1:U76"><span class="mxinfo " id="T1:U77">2</span>^<span class="var type1" id="S48T1U100">IfftOrSum</span></span></span>)</span>)*<span class="var type1" id="S36T1U101">T</span></span>/<span class="var type1" id="S37T1U102">Ta</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="mxinfo " id="T5:U81"><span class="var type1" id="S35T5U105">Ix1</span> = <span class="mxinfo " id="T5:U83">[<span class="mxinfo " id="T5:U84"><span class="var type1" id="S35T5U109">Ix1</span>(<span class="mxinfo " id="T2:U86"><span class="mxinfo " id="T1:U87"><span class="var type1" id="S53T1U112">AuxSyncCorr</span>+<span class="mxinfo " id="T1:U89">1</span></span>:end</span>,<span class="mxinfo " id="T6:U90">:</span>)</span>;<span class="mxinfo " id="T5:U91"><span class="var type1" id="S35T5U119">Ix1</span>(<span class="mxinfo " id="T2:U93"><span class="mxinfo " id="T1:U94">1</span>:<span class="var type1" id="S53T1U122">AuxSyncCorr</span></span>,<span class="mxinfo " id="T6:U96">:</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%The difference between the PossitionTosynchronize and</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%Possitionsynchronized will be used to correct the time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%shifting on the transmition and reception process.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%if AuxSyncCorr&gt;=0%If the difference is positive, left-shift<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%                 Ix = ifft(fft(Ix).*exp(1j*2*pi*f*AuxSyncCorr));          %Shift based on time change</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%Ix = [Ix(AuxSyncCorr+1:end) Ix(1:AuxSyncCorr)];            %Shift based on sampling sliding</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%else%<span class="keyword">...</span><span class="comment"> but if the difference is negative, right-shift</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%                 Ix = ifft(fft(Ix).*exp(-1j*2*pi*f*AuxSyncCorr));         %Shift based on time change</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%Ix = [Ix(end+AuxSyncCorr+1:end) Ix(1:end + AuxSyncCorr)];  %Shift based on sampling sliding</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%if SencondAdjust</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%For some reason that we could not understand sometimes the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%time (sampling) sliding of the signal is not equal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%throught the data stream. Thus, the second part of the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%synchronism process will be turn ON or OFF according to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%the user's will.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%AuxSyncEnd     = (Ix(end-SyncPos+1:end-IniSyncPos-1));     %Selecting the sync-word within the received signal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%SyncSymbEndAux = SyncSymbEnd(end-SyncPos+1:end-<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%IniSyncPos-1);%Selecting the sync-word within the known signal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%AuxSyncEnd1 = AuxSyncEnd;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%AuxSyncEnd1(AuxSyncEnd1&lt;0) = 0;                            %To keep the mean value above zero anything under is neglected</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%AuxSyncEnd1(AuxSyncEnd1&gt;=mean(AuxSyncEnd1)) = 1;           %Adding a flag to the first sample of the received mean value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%AuxSyncEnd1(AuxSyncEnd1&lt;mean(AuxSyncEnd1)) = -1;           %All the others samples at set to the lowest level</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">%AuxSyncEnd2 = SyncSymbEndAux;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%AuxSyncEnd2(AuxSyncEnd2&gt;=mean(AuxSyncEnd2)) = 1;           %Adding a flag to the first sample of the known mean value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%AuxSyncEnd2(AuxSyncEnd2&lt;mean(AuxSyncEnd2)) = -1;           %All the others samples at set to the lowest level</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%PosToSynEnd  = find(ismember(AuxSyncEnd1,1));              %Finding where is the location of the first sample to synchronize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">%PosSynEnd = find(ismember(AuxSyncEnd2,1));                 %Finding where is the location of the first sample to synchronize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">%AuxSyncCorrEnd = PosToSynEnd(round(end/2))-PosSynEnd(<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">%round(end/2));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%The difference between the PossitionTosynchronize and</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">%Possitionsynchronized will be used to correct the time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%shifting on the transmition and reception process.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">%if AuxSyncCorrEnd&gt;=0%If possitive difference, left-shift<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">%                 Ix = ifft(fft(Ix).*exp(1j*2*pi*f*AuxSyncCorrEnd));   %Shift based on time change</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%Ix = [Ix(AuxSyncCorrEnd+1:end) Ix(1:AuxSyncCorrEnd)];  %Shift based on sampling sliding</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%else%<span class="keyword">...</span><span class="comment"> but if the difference is negative, right-shift</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%Ix = ifft(fft(Ix).*exp(-1j*2*pi*f*AuxSyncCorrEnd));  %Shift based on time change</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">%Ix = [Ix(end-AuxSyncCorrEnd+1:end) Ix(1:end - <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%AuxSyncCorrEnd)];%Shift based on sampling sliding</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%%          Ploting the result for qualitative analizes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">%                             PrintInfo(Ploting*35,t(end-SyncPos+1:end-IniSyncPos+1),Ix(<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">%                                 end-SyncPos+1:end-IniSyncPos+1),SyncSymb(end-SyncPos+1:<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%                                                                         end-IniSyncPos+1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%% Removing CP</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U97"><span class="var type1" id="S49T1U127">AddCP</span>==<span class="mxinfo " id="T1:U99">1</span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">    <span class="mxinfo " id="T5:U100"><span class="var type1" id="S56T5U131">IxAux</span> = <span class="mxinfo " id="T5:U102"><span class="var type1" id="S35T5U133">Ix1</span>(<span class="mxinfo " id="T2:U104"><span class="mxinfo " id="T1:U105">1</span>:<span class="mxinfo " id="T1:U106"><span class="mxinfo " id="T1:U107">end</span> - <span class="var type1" id="S39T1U139">StuffSampels</span></span></span>,<span class="mxinfo " id="T6:U109">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">    <span class="mxinfo " id="T5:U110"><span class="var type1" id="S56T5U143">IxAux</span> = <span class="mxinfo " id="T5:U112">reshape(<span class="var type1" id="S56T5U146">IxAux</span>,(<span class="mxinfo " id="T1:U114"><span class="mxinfo " id="T1:U115"><span class="mxinfo " id="T1:U116">2</span>*<span class="var type1" id="S40T1U151">NumAmosCP</span></span>+<span class="var type1" id="S41T1U152">NPPB</span></span>),<span class="mxinfo " id="T1:U119">(<span class="mxinfo " id="T1:U120"><span class="var type1" id="S43T1U156">Nb4Pam</span>/<span class="mxinfo " id="T1:U122">2</span></span>)*<span class="var type1" id="S42T1U158">CurTesSiz</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">    <span class="mxinfo " id="T5:U124"><span class="var type1" id="S56T5U161">IxAux</span> = <span class="mxinfo " id="T5:U126"><span class="var type1" id="S56T5U163">IxAux</span>(<span class="mxinfo " id="T2:U128"><span class="mxinfo " id="T1:U129"><span class="mxinfo " id="T1:U130">1</span>+<span class="var type1" id="S40T1U167">NumAmosCP</span></span>:<span class="mxinfo " id="T1:U132"><span class="mxinfo " id="T1:U133">end</span>-<span class="var type1" id="S40T1U171">NumAmosCP</span></span></span>,<span class="mxinfo " id="T6:U135">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">    <span class="mxinfo " id="T5:U136"><span class="var type1" id="S56T5U175">IxAux</span> = <span class="mxinfo " id="T5:U138">reshape(<span class="var type1" id="S56T5U178">IxAux</span>,<span class="mxinfo " id="T1:U140"><span class="mxinfo " id="T1:U141"><span class="var type1" id="S41T1U181">NPPB</span>*<span class="var type1" id="S43T1U182">Nb4Pam</span></span>/<span class="mxinfo " id="T1:U144">2</span></span>,<span class="var type1" id="S42T1U184">CurTesSiz</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">    <span class="mxinfo " id="T5:U146"><span class="var type1" id="S35T5U187">Ix1</span>    = <span class="var type1" id="S56T5U188">IxAux</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="comment">%% Taking the sampling the EVM meassurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"><span class="mxinfo " id="T5:U149"><span class="var type1" id="S5T5U191">Ix</span> = <span class="mxinfo " id="T5:U151"><span class="var type1" id="S35T5U193">Ix1</span>(<span class="mxinfo " id="T2:U153"><span class="mxinfo " id="T1:U154"><span class="mxinfo " id="T1:U155">1</span>+<span class="mxinfo " id="T1:U156"><span class="var type1" id="S50T1U198">SyncPeriod</span>*<span class="var type1" id="S41T1U199">NPPB</span></span></span>:<span class="mxinfo " id="T1:U159"><span class="mxinfo " id="T1:U160">end</span>-<span class="mxinfo " id="T1:U161"><span class="var type1" id="S50T1U204">SyncPeriod</span>*<span class="var type1" id="S41T1U205">NPPB</span></span></span></span>,<span class="mxinfo " id="T6:U164">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="mxinfo " id="T2:U165"><span class="var type1" id="S5T2U209">Ix</span> = <span class="mxinfo " id="T2:U167">reshape(<span class="var type1" id="S5T5U212">Ix</span>,1,<span class="mxinfo " id="T1:U169"><span class="mxinfo " id="T1:U170">size(<span class="var type1" id="S5T5U217">Ix</span>,1)</span>*<span class="mxinfo " id="T1:U172">size(<span class="var type1" id="S5T5U221">Ix</span>,2)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"><span class="comment">%PosAuxEout = NPPB/2:NPPB:length(Ix);%Varriable respossible to take just the samples at the middle of the symbol</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="comment">%IxAux      = Ix(PosAuxEout);                           %Normalizing the reference</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="comment">%RxSymbAmos(CurrentTest,ObsCarrPos==ThisCarr,:) = IxAux;%RxSymbAmosUp = [];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="comment">%EvmMatRec(ObsCarrPos==ThisCarr,:) = IxAux;                       %Taking just the middle samples as references</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="comment">%[EvmDB(CurrentTest,ThisCarr), EvmPer(CurrentTest,ThisCarr), EvmRms(CurrentTest,ThisCarr) ] = EvmCalc( EvmMatRef(ObsCarrPos==ThisCarr,:),IxAux );</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="comment">%[EvmDBJ(CurrentTest,ThisCarr),EvmPerJ(CurrentTest,ThisCarr),EvmRmsJ(CurrentTest,ThisCarr)] = evm1(4,'pam',EvmMatRef(ObsCarrPos==ThisCarr,:),IxAux);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"><span class="comment">%%         Finding Decission Levels</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">%The process for decoding the income signal will be based on</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%eletronic comparators. Inasmuch as the right decission level</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">%must be acquired for accurately decide, within a symbol</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="comment">%periode, what that current leavel means (ones or zeros).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">%The process hereafter of chosing the  decission levels is not</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="comment">%deterministic rather it is a statistic process. The main idea</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">%is to take the decission level from the histogram generated</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">%from the income signal stream.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="comment">%Firstly it was set the interval in which the histogram will be</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">%build. It is based on the number of samples per bit period.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="comment">%             IxToSeek = reshape(Ix(1+SyncPeriod*NPPB:end-SyncPeriod*NPPB<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"><span class="comment">%                                        ),NPPB,(Nb4Pam/2) - (2*SyncPeriod));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="mxinfo " id="T2:U174"><span class="var type1" id="S59T2U225">Interval</span> = <span class="mxinfo " id="T2:U176">linspace(<span class="mxinfo " id="T1:U177">min(<span class="var type1" id="S5T2U230">Ix</span>)</span>,<span class="mxinfo " id="T1:U179">max(<span class="var type1" id="S5T2U233">Ix</span>)</span>,<span class="var type1" id="S44T1U234">IntervalStep</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="comment">%Therefore, the MATLAB hist function returns the number of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="comment">%occurrence of each interval.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="mxinfo " id="T2:U182"><span class="var type1" id="S63T2U237">EyeMax</span> = <span class="mxinfo " id="T2:U184">hist(<span class="var type1" id="S5T2U240">Ix</span>,<span class="var type1" id="S59T2U241">Interval</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="mxinfo " id="T2:U187"><span class="var type1" id="S65T2U244">EyeMaxaux</span> = <span class="mxinfo " id="T2:U189">[<span class="mxinfo " id="T1:U190">0</span> <span class="var type1" id="S63T2U248">EyeMax</span> <span class="mxinfo " id="T1:U192">0</span>]</span></span>;                                      <span class="comment">%Zeros are added at the EyeMax to auxiliate the finding peaks process</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">[<span class="mxinfo " id="T1:U193">~</span>,<span class="var type1" id="S66T2U254">EyeLoc</span>] = findpeaks(<span class="var type1" id="S65T2U257">EyeMaxaux</span>,<span class="string">'MinPeakDistance'</span>,<span class="var type1" id="S45T1U259">MinDist</span>,<span class="string">'SortStr'</span>,<span class="string">'descend'</span>,<span class="string">'NPeaks'</span>,4);<span class="comment">%,'MinPeakHeight',mean(EyeMax));%The peaks on the Eye profile will be the levels at the Eyes limit</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U197"><span class="mxinfo " id="T1:U198">length(<span class="var type1" id="S66T2U269">EyeLoc</span>)</span>&lt;<span class="mxinfo " id="T1:U200">4</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">    [<span class="mxinfo " id="T1:U201">~</span>,<span class="var type1" id="S66T2U275">EyeLoc</span>] = findpeaks(<span class="var type1" id="S65T2U278">EyeMaxaux</span>,<span class="string">'MinPeakDistance'</span>,<span class="mxinfo " id="T1:U204"><span class="var type1" id="S45T1U281">MinDist</span>*<span class="mxinfo " id="T1:U206">0.8</span></span>,<span class="string">'SortStr'</span>,<span class="string">'descend'</span>,<span class="string">'NPeaks'</span>,4);<span class="comment">%,'MinPeakHeight',mean(EyeMax)/4);%The peaks on the Eye profile will be the levels at the Eyes limit</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="comment">%This variable will brings the eye profile of the input signal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"><span class="comment">%that will be used to generate the decision level. Basicaly the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="comment">%decission level will be the minimal value of the currente eye</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"><span class="comment">%under evaluation plus the half of the its eye opening. The</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="comment">%following ilustration better describe this process.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="comment">%Eye Limits:   + (1/2 * Eye Opening:)  =    Comparisson Limits:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="comment">%UperLevel  ______     ______________     _____</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="comment">%                 \   /      |       \   /</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"><span class="comment">%                  \ /       |        \ /</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line"><span class="comment">%                   \ Half Eye Opening /     Decission Level 3</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="comment">%                  / \       |        / \</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"><span class="comment">%LowerLevel 3_____/   \______|_______/   \_____</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line"><span class="comment">%                 \   /      |       \   /</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"><span class="comment">%                  \ /       |        \ /</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"><span class="comment">%                   \ Half Eye Opening /     Decission Level 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"><span class="comment">%                  / \       |        / \</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"><span class="comment">%LowerLevel 2_____/   \______|_______/   \_____</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"><span class="comment">%                 \   /      |       \   /</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line"><span class="comment">%                  \ /       |        \ /</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"><span class="comment">%                   \ Half Eye Opening /     Decission Level 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line"><span class="comment">%                  / \       |        / \</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"><span class="comment">%LowerLevel 1_____/   \______|_______/   \_____</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"><span class="comment">%%           Ploting for Qualitative Analizes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"><span class="comment">%             PrintInfo(Ploting*37,Interval,EyeMax);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"><span class="comment">%%         Finding Decission Levels</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line"><span class="comment">%It is not always possible to totaly recover the signal.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line"><span class="comment">%Depending on the configuration of the transmition and</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line"><span class="comment">%reception system the eye diagram may be nonexistent. Which</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line"><span class="comment">%means, there will not be a profile to be found therefore the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line"><span class="comment">%EyeLoc will not return the correct location. Inasmuch as the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line"><span class="comment">%detection process to works limts will be set accordling to the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line"><span class="comment">%amplitude of the received signal.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U207"><span class="mxinfo " id="T1:U208">length(<span class="var type1" id="S66T2U292">EyeLoc</span>)</span>&lt;<span class="mxinfo " id="T1:U210">4</span></span><span class="comment">%If it was not able to find the eye profile.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">    <span class="comment">%EyeLoc = [2 3 4 5];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">    <span class="mxinfo " id="T4:U211"><span class="var type1" id="S34T4U296">Levels</span> = <span class="mxinfo " id="T8:U213">[<span class="mxinfo " id="T1:U214">0</span> <span class="mxinfo " id="T1:U215">0</span> <span class="mxinfo " id="T1:U216">0.35</span> <span class="mxinfo " id="T1:U217">0.55</span> <span class="mxinfo " id="T1:U218">0.85</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">    <span class="comment">%                 Levels = sort(Levels);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">    <span class="comment">%                 LevelDec1 = mean(Ix) - 2*mean(Ix)/3 ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">    <span class="comment">%                 LevelDec2 = mean(Ix) ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">    <span class="comment">%                 LevelDec3 = mean(Ix) + 2*mean(Ix)/3 ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line"><span class="keyword">else</span><span class="comment">%Whereas, if there is an profile the decission can be found</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo " id="T9:U219"><span class="var type1" id="S34T9U307">Levels</span> = <span class="mxinfo " id="T9:U221">[<span class="mxinfo " id="T1:U222"><span class="var type1" id="S59T2U311">Interval</span>(<span class="mxinfo " id="T1:U224"><span class="mxinfo " id="T1:U225"><span class="var type1" id="S66T2U314">EyeLoc</span>(<span class="mxinfo " id="T1:U227">1</span>)</span>-<span class="mxinfo " id="T1:U228">1</span></span>)</span> <span class="mxinfo " id="T1:U229"><span class="var type1" id="S59T2U318">Interval</span>(<span class="mxinfo " id="T1:U231"><span class="mxinfo " id="T1:U232"><span class="var type1" id="S66T2U321">EyeLoc</span>(<span class="mxinfo " id="T1:U234">2</span>)</span>-<span class="mxinfo " id="T1:U235">1</span></span>)</span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">        <span class="mxinfo " id="T1:U236"><span class="var type1" id="S59T2U325">Interval</span>(<span class="mxinfo " id="T1:U238"><span class="mxinfo " id="T1:U239"><span class="var type1" id="S66T2U328">EyeLoc</span>(<span class="mxinfo " id="T1:U241">3</span>)</span>-<span class="mxinfo " id="T1:U242">1</span></span>)</span> <span class="mxinfo " id="T1:U243"><span class="var type1" id="S59T2U332">Interval</span>(<span class="mxinfo " id="T1:U245"><span class="mxinfo " id="T1:U246"><span class="var type1" id="S66T2U335">EyeLoc</span>(<span class="mxinfo " id="T1:U248">4</span>)</span>-<span class="mxinfo " id="T1:U249">1</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">    <span class="mxinfo " id="T4:U250"><span class="var type1" id="S34T4U340">Levels</span> = <span class="mxinfo " id="T9:U252">sort(<span class="var type1" id="S34T9U343">Levels</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">    <span class="comment">%                 LevelDec1 = Levels(1) + (Levels(2)-Levels(1))/2 ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">    <span class="comment">%                 LevelDec2 = Levels(2) + (Levels(3)-Levels(2))/2 ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">    <span class="comment">%                 LevelDec3 = Levels(3) + (Levels(4)-Levels(3))/2 ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line"><span class="comment">%##############################################################</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line"><span class="comment">%##############################################################</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="mxinfo " id="T2:U254"><span class="var type1" id="S70T2U346">PosIx</span> = <span class="mxinfo " id="T2:U256"><span class="mxinfo " id="T1:U257"><span class="var type1" id="S41T1U350">NPPB</span>/<span class="mxinfo " id="T1:U259">2</span></span>:<span class="var type1" id="S41T1U352">NPPB</span>:<span class="mxinfo " id="T1:U261">length(<span class="var type1" id="S5T2U355">Ix</span>)</span></span></span>;                                <span class="comment">%Possition of the central samples - but the number of samples per symbol is even ????</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"><span class="mxinfo " id="T2:U263"><span class="var type1" id="S56T2U358">IxAux</span> = <span class="mxinfo " id="T2:U265"><span class="var type1" id="S5T2U360">Ix</span>(<span class="var type1" id="S70T2U361">PosIx</span>)</span></span>;                                             <span class="comment">%From the main received signal just a few samples are taken for further evaluation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"><span class="mxinfo " id="T1:U268"><span class="var type1" id="S71T1U364">n</span>     = <span class="mxinfo " id="T1:U270">100</span></span>;                                                   <span class="comment">%The number of boxes to be filled up on the histogram process</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"><span class="comment">%At this process each eye will be evaluated separetelly. It is</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="comment">%important to remember that the PAM4 has 4 levels, which means</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"><span class="comment">%three level of decissions that are exaclty the center of the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"><span class="comment">%eye diagram.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo " id="T2:U271"><span class="var type1" id="S72T2U368">IxAuxAB</span> = <span class="mxinfo " id="T2:U273"><span class="var type1" id="S56T2U370">IxAux</span>(<span class="mxinfo " id="T10:U275">(<span class="mxinfo " id="T10:U276"><span class="var type1" id="S56T2U374">IxAux</span>&lt;=<span class="mxinfo " id="T1:U278"><span class="var type1" id="S34T4U376">Levels</span>(<span class="mxinfo " id="T1:U280">4</span>)</span></span>)&amp;(<span class="mxinfo " id="T10:U281"><span class="var type1" id="S56T2U380">IxAux</span>&gt;=<span class="mxinfo " id="T1:U283"><span class="var type1" id="S34T4U382">Levels</span>(<span class="mxinfo " id="T1:U285">3</span>)</span></span>)</span>)</span></span>;        <span class="comment">%Taking just those values relative to the uper eye</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"><span class="mxinfo " id="T3:U286"><span class="var type1" id="S22T3U386">InterAB</span> = <span class="mxinfo " id="T3:U288">linspace(<span class="mxinfo " id="T1:U289"><span class="var type1" id="S34T4U390">Levels</span>(<span class="mxinfo " id="T1:U291">3</span>)</span>,<span class="mxinfo " id="T1:U292"><span class="var type1" id="S34T4U393">Levels</span>(<span class="mxinfo " id="T1:U294">4</span>)</span>,<span class="var type1" id="S71T1U395">n</span>)</span></span>;                     <span class="comment">%Building the histogram boxes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo " id="T3:U296"><span class="var type1" id="S73T3U398">EyeAB</span> = <span class="mxinfo " id="T3:U298">hist(<span class="var type1" id="S72T2U401">IxAuxAB</span>,<span class="var type1" id="S22T3U402">InterAB</span>)</span></span>;                                 <span class="comment">%filling up the boxes with samples that fit on them.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"><span class="comment">%The same process described for the uper level will be done at</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"><span class="comment">%the middle and lower eyes levels.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="mxinfo " id="T2:U301"><span class="var type1" id="S74T2U405">IxAuxCD</span> = <span class="mxinfo " id="T2:U303"><span class="var type1" id="S56T2U407">IxAux</span>(<span class="mxinfo " id="T10:U305">(<span class="mxinfo " id="T10:U306"><span class="var type1" id="S56T2U411">IxAux</span>&lt;=<span class="mxinfo " id="T1:U308"><span class="var type1" id="S34T4U413">Levels</span>(<span class="mxinfo " id="T1:U310">3</span>)</span></span>)&amp;(<span class="mxinfo " id="T10:U311"><span class="var type1" id="S56T2U417">IxAux</span>&gt;=<span class="mxinfo " id="T1:U313"><span class="var type1" id="S34T4U419">Levels</span>(<span class="mxinfo " id="T1:U315">2</span>)</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="mxinfo " id="T3:U316"><span class="var type1" id="S23T3U423">InterCD</span> = <span class="mxinfo " id="T3:U318">linspace(<span class="mxinfo " id="T1:U319"><span class="var type1" id="S34T4U427">Levels</span>(<span class="mxinfo " id="T1:U321">2</span>)</span>,<span class="mxinfo " id="T1:U322"><span class="var type1" id="S34T4U430">Levels</span>(<span class="mxinfo " id="T1:U324">3</span>)</span>,<span class="var type1" id="S71T1U432">n</span>)</span></span>;<span class="comment">%NPPB*2^n);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"><span class="mxinfo " id="T3:U326"><span class="var type1" id="S75T3U435">EyeCD</span> = <span class="mxinfo " id="T3:U328">hist(<span class="var type1" id="S74T2U438">IxAuxCD</span>,<span class="var type1" id="S23T3U439">InterCD</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line"><span class="mxinfo " id="T2:U331"><span class="var type1" id="S76T2U442">IxAuxEF</span> = <span class="mxinfo " id="T2:U333"><span class="var type1" id="S56T2U444">IxAux</span>(<span class="mxinfo " id="T10:U335">(<span class="mxinfo " id="T10:U336"><span class="var type1" id="S56T2U448">IxAux</span>&lt;=<span class="mxinfo " id="T1:U338"><span class="var type1" id="S34T4U450">Levels</span>(<span class="mxinfo " id="T1:U340">2</span>)</span></span>)&amp;(<span class="mxinfo " id="T10:U341"><span class="var type1" id="S56T2U454">IxAux</span>&gt;=<span class="mxinfo " id="T1:U343"><span class="var type1" id="S34T4U456">Levels</span>(<span class="mxinfo " id="T1:U345">1</span>)</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"><span class="mxinfo " id="T3:U346"><span class="var type1" id="S24T3U460">InterEF</span> = <span class="mxinfo " id="T3:U348">linspace(<span class="mxinfo " id="T1:U349"><span class="var type1" id="S34T4U464">Levels</span>(<span class="mxinfo " id="T1:U351">1</span>)</span>,<span class="mxinfo " id="T1:U352"><span class="var type1" id="S34T4U467">Levels</span>(<span class="mxinfo " id="T1:U354">2</span>)</span>,<span class="var type1" id="S71T1U469">n</span>)</span></span>;<span class="comment">%NPPB*2^n);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"><span class="mxinfo " id="T3:U356"><span class="var type1" id="S77T3U472">EyeEF</span> = <span class="mxinfo " id="T3:U358">hist(<span class="var type1" id="S76T2U475">IxAuxEF</span>,<span class="var type1" id="S24T3U476">InterEF</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"><span class="comment">%What we are looking for here are not where exist the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"><span class="comment">%occurrences of values. The eye is where there is not samples,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="comment">%this means, the decission level is a reagion between actual</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"><span class="comment">%levels thus this reagion does not contain any signal.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line"><span class="mxinfo " id="T11:U361"><span class="var type1" id="S73T11U479">EyeAB</span> = <span class="mxinfo " id="T11:U363">~<span class="var type1" id="S73T3U481">EyeAB</span></span></span>;                                                <span class="comment">%Changing zeros to one - Zeros compose the eye region</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line"><span class="mxinfo " id="T11:U365"><span class="var type1" id="S75T11U484">EyeCD</span> = <span class="mxinfo " id="T11:U367">~<span class="var type1" id="S75T3U486">EyeCD</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line"><span class="mxinfo " id="T11:U369"><span class="var type1" id="S77T11U489">EyeEF</span> = <span class="mxinfo " id="T11:U371">~<span class="var type1" id="S77T3U491">EyeEF</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line"><span class="comment">%Starting variables that will be used to identify the eye</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"><span class="comment">%diagram.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line"><span class="mxinfo " id="T1:U373"><span class="var type1" id="S78T1U494">CountAB</span>   = <span class="mxinfo " id="T1:U375">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line"><span class="mxinfo " id="T1:U376"><span class="var type1" id="S79T1U498">CountCD</span>   = <span class="mxinfo " id="T1:U378">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="mxinfo " id="T1:U379"><span class="var type1" id="S80T1U502">CountEF</span>   = <span class="mxinfo " id="T1:U381">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="mxinfo " id="T3:U382"><span class="var type1" id="S81T3U506">SeqOnesAB</span> = <span class="mxinfo " id="T3:U384">zeros(<span class="mxinfo " id="T1:U385">1</span>,<span class="mxinfo " id="T1:U386">length(<span class="var type1" id="S73T11U512">EyeAB</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line"><span class="mxinfo " id="T3:U388"><span class="var type1" id="S83T3U515">SeqOnesCD</span> = <span class="mxinfo " id="T3:U390">zeros(<span class="mxinfo " id="T1:U391">1</span>,<span class="mxinfo " id="T1:U392">length(<span class="var type1" id="S73T11U521">EyeAB</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line"><span class="mxinfo " id="T3:U394"><span class="var type1" id="S84T3U524">SeqOnesEF</span> = <span class="mxinfo " id="T3:U396">zeros(<span class="mxinfo " id="T1:U397">1</span>,<span class="mxinfo " id="T1:U398">length(<span class="var type1" id="S73T11U530">EyeAB</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="mxinfo " id="T3:U400"><span class="var type1" id="S25T3U533">SeqFinAB</span>  = <span class="mxinfo " id="T3:U402">zeros(<span class="mxinfo " id="T1:U403">1</span>,<span class="mxinfo " id="T1:U404">length(<span class="var type1" id="S73T11U539">EyeAB</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"><span class="mxinfo " id="T3:U406"><span class="var type1" id="S26T3U542">SeqFinCD</span>  = <span class="mxinfo " id="T3:U408">zeros(<span class="mxinfo " id="T1:U409">1</span>,<span class="mxinfo " id="T1:U410">length(<span class="var type1" id="S73T11U548">EyeAB</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"><span class="mxinfo " id="T3:U412"><span class="var type1" id="S27T3U551">SeqFinEF</span>  = <span class="mxinfo " id="T3:U414">zeros(<span class="mxinfo " id="T1:U415">1</span>,<span class="mxinfo " id="T1:U416">length(<span class="var type1" id="S73T11U557">EyeAB</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line"><span class="mxinfo " id="T1:U418"><span class="var type1" id="S85T1U560">SeqIniAB</span>  = <span class="mxinfo " id="T1:U420">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line"><span class="mxinfo " id="T1:U421"><span class="var type1" id="S86T1U564">SeqIniCD</span>  = <span class="mxinfo " id="T1:U423">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line"><span class="mxinfo " id="T1:U424"><span class="var type1" id="S87T1U568">SeqIniEF</span>  = <span class="mxinfo " id="T1:U426">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line"><span class="comment">%The for loop will take account of every box with ones. It is</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line"><span class="comment">%important to take note that the not operator was used in this</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line"><span class="comment">%vector, therefore ones means zeros (the eye diagram -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line"><span class="comment">%possibly) and zeros means values abouve zeroa (not the eye).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S88T1U572">kk</span>=<span class="mxinfo " id="T1:U428">1</span>:length(<span class="var type1" id="S73T11U577">EyeAB</span>)                                         <span class="comment">%For every box</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U430"><span class="var type1" id="S73T11U581">EyeAB</span>(<span class="var type1" id="S88T1U582">kk</span>)</span>                                               <span class="comment">%if it contains "1"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line">        <span class="mxinfo " id="T1:U433"><span class="mxinfo " id="T1:U434"><span class="var type1" id="S81T3U586">SeqOnesAB</span>(<span class="var type1" id="S85T1U587">SeqIniAB</span>)</span>=<span class="var type1" id="S78T1U588">CountAB</span></span>;                           <span class="comment">%count this element as part of a consecutive sequency</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">        <span class="mxinfo " id="T1:U438"><span class="var type1" id="S78T1U591">CountAB</span> = <span class="mxinfo " id="T1:U440"><span class="var type1" id="S78T1U593">CountAB</span> + <span class="mxinfo " id="T1:U442">1</span></span></span>;                                 <span class="comment">%adds one to the counter of consecutive elements "1"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U443"><span class="var type1" id="S88T1U598">kk</span>==<span class="mxinfo " id="T1:U445">length(<span class="var type1" id="S73T11U601">EyeAB</span>)</span></span>                                   <span class="comment">%if the current box is the last box we got to an end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line">            <span class="mxinfo " id="T1:U447"><span class="mxinfo " id="T1:U448"><span class="var type1" id="S25T3U605">SeqFinAB</span>(<span class="var type1" id="S85T1U606">SeqIniAB</span>)</span> = <span class="var type1" id="S88T1U607">kk</span></span>;                           <span class="comment">%The final sequency element is equal to its possition (kk)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">    <span class="keyword">else</span>                                                       <span class="comment">%else if the current box contains "0"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">        <span class="mxinfo " id="T1:U452"><span class="mxinfo " id="T1:U453"><span class="var type1" id="S25T3U612">SeqFinAB</span>(<span class="var type1" id="S85T1U613">SeqIniAB</span>)</span> = <span class="mxinfo " id="T1:U456"><span class="var type1" id="S88T1U615">kk</span>-<span class="mxinfo " id="T1:U458">1</span></span></span>;                             <span class="comment">%the previous element was the last element of a consecutive sequency of ones</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line">        <span class="mxinfo " id="T1:U459"><span class="var type1" id="S85T1U619">SeqIniAB</span> = <span class="mxinfo " id="T1:U461"><span class="var type1" id="S85T1U621">SeqIniAB</span> + <span class="mxinfo " id="T1:U463">1</span></span></span>;                               <span class="comment">%adds one to the counter of consecutive number (take in account how many sequencies there are)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line">        <span class="mxinfo " id="T1:U464"><span class="var type1" id="S78T1U625">CountAB</span> = <span class="mxinfo " id="T1:U466">1</span></span>;                                           <span class="comment">%reset the counter of consecutive elements to mark the start of a new consecutive sequence</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U467"><span class="var type1" id="S75T11U630">EyeCD</span>(<span class="var type1" id="S88T1U631">kk</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line">        <span class="mxinfo " id="T1:U470"><span class="mxinfo " id="T1:U471"><span class="var type1" id="S83T3U635">SeqOnesCD</span>(<span class="var type1" id="S86T1U636">SeqIniCD</span>)</span>=<span class="var type1" id="S79T1U637">CountCD</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line">        <span class="mxinfo " id="T1:U475"><span class="var type1" id="S79T1U640">CountCD</span> = <span class="mxinfo " id="T1:U477"><span class="var type1" id="S79T1U642">CountCD</span> + <span class="mxinfo " id="T1:U479">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U480"><span class="var type1" id="S88T1U647">kk</span>==<span class="mxinfo " id="T1:U482">length(<span class="var type1" id="S75T11U650">EyeCD</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line">            <span class="mxinfo " id="T1:U484"><span class="mxinfo " id="T1:U485"><span class="var type1" id="S26T3U654">SeqFinCD</span>(<span class="var type1" id="S86T1U655">SeqIniCD</span>)</span> = <span class="var type1" id="S88T1U656">kk</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line">        <span class="mxinfo " id="T1:U489"><span class="mxinfo " id="T1:U490"><span class="var type1" id="S26T3U661">SeqFinCD</span>(<span class="var type1" id="S86T1U662">SeqIniCD</span>)</span> = <span class="mxinfo " id="T1:U493"><span class="var type1" id="S88T1U664">kk</span>-<span class="mxinfo " id="T1:U495">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line">        <span class="mxinfo " id="T1:U496"><span class="var type1" id="S86T1U668">SeqIniCD</span> = <span class="mxinfo " id="T1:U498"><span class="var type1" id="S86T1U670">SeqIniCD</span> + <span class="mxinfo " id="T1:U500">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line">        <span class="mxinfo " id="T1:U501"><span class="var type1" id="S79T1U674">CountCD</span> = <span class="mxinfo " id="T1:U503">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U504"><span class="var type1" id="S77T11U679">EyeEF</span>(<span class="var type1" id="S88T1U680">kk</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line">        <span class="mxinfo " id="T1:U507"><span class="mxinfo " id="T1:U508"><span class="var type1" id="S84T3U684">SeqOnesEF</span>(<span class="var type1" id="S87T1U685">SeqIniEF</span>)</span>=<span class="var type1" id="S80T1U686">CountEF</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line">        <span class="mxinfo " id="T1:U512"><span class="var type1" id="S80T1U689">CountEF</span> = <span class="mxinfo " id="T1:U514"><span class="var type1" id="S80T1U691">CountEF</span> + <span class="mxinfo " id="T1:U516">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U517"><span class="var type1" id="S88T1U696">kk</span>==<span class="mxinfo " id="T1:U519">length(<span class="var type1" id="S77T11U699">EyeEF</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line">            <span class="mxinfo " id="T1:U521"><span class="mxinfo " id="T1:U522"><span class="var type1" id="S27T3U703">SeqFinEF</span>(<span class="var type1" id="S87T1U704">SeqIniEF</span>)</span> = <span class="var type1" id="S88T1U705">kk</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231">231</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232">232</a></span><span class="line">        <span class="mxinfo " id="T1:U526"><span class="mxinfo " id="T1:U527"><span class="var type1" id="S27T3U710">SeqFinEF</span>(<span class="var type1" id="S87T1U711">SeqIniEF</span>)</span> = <span class="mxinfo " id="T1:U530"><span class="var type1" id="S88T1U713">kk</span>-<span class="mxinfo " id="T1:U532">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233">233</a></span><span class="line">        <span class="mxinfo " id="T1:U533"><span class="var type1" id="S87T1U717">SeqIniEF</span> = <span class="mxinfo " id="T1:U535"><span class="var type1" id="S87T1U719">SeqIniEF</span> + <span class="mxinfo " id="T1:U537">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,234" id="srcline234">234</a></span><span class="line">        <span class="mxinfo " id="T1:U538"><span class="var type1" id="S80T1U723">CountEF</span> = <span class="mxinfo " id="T1:U540">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,235" id="srcline235">235</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,236" id="srcline236">236</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,237" id="srcline237">237</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,238" id="srcline238">238</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,239" id="srcline239">239</a></span><span class="line"><span class="comment">%If the eye is open, which means there is a clear difference</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,240" id="srcline240">240</a></span><span class="line"><span class="comment">%between adjacent levels, the eye diagram will be the longest</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,241" id="srcline241">241</a></span><span class="line"><span class="comment">%sequence of ones.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,242" id="srcline242">242</a></span><span class="line">[<span class="var type1" id="S31T1U728">MaxValAB</span>,<span class="var type1" id="S28T1U729">LocMaxAB</span>]=max(<span class="var type1" id="S81T3U732">SeqOnesAB</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,243" id="srcline243">243</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U544"><span class="var type1" id="S28T1U737">LocMaxAB</span>&lt;<span class="mxinfo " id="T1:U546">1</span></span> || <span class="mxinfo " id="T7:U547"><span class="var type1" id="S31T1U740">MaxValAB</span>&lt;<span class="mxinfo " id="T1:U549">2</span></span>                                    <span class="comment">%if any sequency was found or there is just one sequency it is a error thus</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,244" id="srcline244">244</a></span><span class="line">    <span class="mxinfo " id="T1:U550"><span class="var type1" id="S4T1U744">LevDec3</span> = <span class="mxinfo " id="T1:U552">0.6953</span></span>;                                            <span class="comment">%the decission level will be by default 0.67. Also, the other variables will</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,245" id="srcline245">245</a></span><span class="line">    <span class="mxinfo " id="T1:U553"><span class="var type1" id="S28T1U748">LocMaxAB</span> = <span class="mxinfo " id="T1:U555">1</span></span>;                                              <span class="comment">%will be set with values to not cause errors in the future</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,246" id="srcline246">246</a></span><span class="line">    <span class="mxinfo " id="T1:U556"><span class="mxinfo " id="T1:U557"><span class="var type1" id="S25T3U753">SeqFinAB</span>(<span class="mxinfo " id="T1:U559">1</span>)</span>=<span class="mxinfo " id="T1:U560">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,247" id="srcline247">247</a></span><span class="line">    <span class="mxinfo " id="T1:U561"><span class="var type1" id="S31T1U758">MaxValAB</span> = <span class="mxinfo " id="T1:U563">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,248" id="srcline248">248</a></span><span class="line">    <span class="mxinfo " id="T1:U564"><span class="mxinfo " id="T1:U565"><span class="var type1" id="S22T3U763">InterAB</span>(<span class="mxinfo " id="T1:U567">1</span>)</span>=<span class="var type1" id="S4T1U765">LevDec3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,249" id="srcline249">249</a></span><span class="line"><span class="keyword">else</span>                                                           <span class="comment">%if a sequency was found the middle of the eye will be the middle of the sequency</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,250" id="srcline250">250</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U569">(<span class="mxinfo " id="T1:U570"><span class="mxinfo " id="T1:U571"><span class="var type1" id="S25T3U773">SeqFinAB</span>(<span class="var type1" id="S28T1U774">LocMaxAB</span>)</span>-<span class="mxinfo " id="T1:U574"><span class="var type1" id="S31T1U776">MaxValAB</span>/<span class="mxinfo " id="T1:U576">2</span></span></span>)&lt;<span class="mxinfo " id="T1:U577">1</span></span>                       <span class="comment">%if for some reason the final element of the sequency minus the half of its</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,251" id="srcline251">251</a></span><span class="line">        <span class="mxinfo " id="T1:U578"><span class="var type1" id="S4T1U781">LevDec3</span> = <span class="mxinfo " id="T1:U580">0.6953</span></span>;                                         <span class="comment">%length results in a negative value, something went very wrong, and by</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,252" id="srcline252">252</a></span><span class="line">    <span class="keyword">else</span>                                                       <span class="comment">%default it will be set to 0.7</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,253" id="srcline253">253</a></span><span class="line">        <span class="mxinfo " id="T1:U581"><span class="var type1" id="S4T1U786">LevDec3</span> = <span class="mxinfo " id="T1:U583"><span class="var type1" id="S22T3U788">InterAB</span>(<span class="mxinfo " id="T1:U585">round(<span class="mxinfo " id="T1:U586"><span class="mxinfo " id="T1:U587"><span class="var type1" id="S25T3U793">SeqFinAB</span>(<span class="var type1" id="S28T1U794">LocMaxAB</span>)</span>-<span class="mxinfo " id="T1:U590"><span class="var type1" id="S31T1U796">MaxValAB</span>/<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,254" id="srcline254">254</a></span><span class="line">            <span class="mxinfo " id="T1:U592">2</span></span></span>)</span>)</span></span>;<span class="comment">%Otherwise, the decission level is the middle of the sequency</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255">255</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256">256</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257">257</a></span><span class="line">[<span class="var type1" id="S32T1U801">MaxValCD</span>,<span class="var type1" id="S29T1U802">LocMaxCD</span>]=max(<span class="var type1" id="S83T3U805">SeqOnesCD</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258">258</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U596"><span class="var type1" id="S29T1U810">LocMaxCD</span>&lt;<span class="mxinfo " id="T1:U598">1</span></span> || <span class="mxinfo " id="T7:U599"><span class="var type1" id="S32T1U813">MaxValCD</span>&lt;<span class="mxinfo " id="T1:U601">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259">259</a></span><span class="line">    <span class="mxinfo " id="T1:U602"><span class="var type1" id="S3T1U817">LevDec2</span> = <span class="mxinfo " id="T1:U604">0.4013</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260">260</a></span><span class="line">    <span class="mxinfo " id="T1:U605"><span class="var type1" id="S29T1U821">LocMaxCD</span> = <span class="mxinfo " id="T1:U607">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261">261</a></span><span class="line">    <span class="mxinfo " id="T1:U608"><span class="mxinfo " id="T1:U609"><span class="var type1" id="S26T3U826">SeqFinCD</span>(<span class="mxinfo " id="T1:U611">1</span>)</span>=<span class="mxinfo " id="T1:U612">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,262" id="srcline262">262</a></span><span class="line">    <span class="mxinfo " id="T1:U613"><span class="var type1" id="S32T1U831">MaxValCD</span> = <span class="mxinfo " id="T1:U615">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,263" id="srcline263">263</a></span><span class="line">    <span class="mxinfo " id="T1:U616"><span class="mxinfo " id="T1:U617"><span class="var type1" id="S23T3U836">InterCD</span>(<span class="mxinfo " id="T1:U619">1</span>)</span>=<span class="var type1" id="S3T1U838">LevDec2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,264" id="srcline264">264</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,265" id="srcline265">265</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U621">(<span class="mxinfo " id="T1:U622"><span class="mxinfo " id="T1:U623"><span class="var type1" id="S26T3U846">SeqFinCD</span>(<span class="var type1" id="S29T1U847">LocMaxCD</span>)</span>-<span class="mxinfo " id="T1:U626"><span class="var type1" id="S32T1U849">MaxValCD</span>/<span class="mxinfo " id="T1:U628">2</span></span></span>)&lt;<span class="mxinfo " id="T1:U629">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266">266</a></span><span class="line">        <span class="mxinfo " id="T1:U630"><span class="var type1" id="S3T1U854">LevDec2</span> = <span class="mxinfo " id="T1:U632">0.4013</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267">267</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268">268</a></span><span class="line">        <span class="mxinfo " id="T1:U633"><span class="var type1" id="S3T1U859">LevDec2</span> = <span class="mxinfo " id="T1:U635"><span class="var type1" id="S23T3U861">InterCD</span>(<span class="mxinfo " id="T1:U637">round(<span class="mxinfo " id="T1:U638"><span class="mxinfo " id="T1:U639"><span class="var type1" id="S26T3U866">SeqFinCD</span>(<span class="var type1" id="S29T1U867">LocMaxCD</span>)</span>-<span class="mxinfo " id="T1:U642"><span class="var type1" id="S32T1U869">MaxValCD</span>/<span class="mxinfo " id="T1:U644">2</span></span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,269" id="srcline269">269</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,270" id="srcline270">270</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,271" id="srcline271">271</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,272" id="srcline272">272</a></span><span class="line">[<span class="var type1" id="S33T1U874">MaxValEF</span>,<span class="var type1" id="S30T1U875">LocMaxEF</span>]=max(<span class="var type1" id="S84T3U878">SeqOnesEF</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,273" id="srcline273">273</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U648"><span class="var type1" id="S30T1U883">LocMaxEF</span>&lt;<span class="mxinfo " id="T1:U650">1</span></span> || <span class="mxinfo " id="T7:U651"><span class="var type1" id="S33T1U886">MaxValEF</span>&lt;<span class="mxinfo " id="T1:U653">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,274" id="srcline274">274</a></span><span class="line">    <span class="mxinfo " id="T1:U654"><span class="var type1" id="S2T1U890">LevDec1</span> = <span class="mxinfo " id="T1:U656">0.1877</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,275" id="srcline275">275</a></span><span class="line">    <span class="mxinfo " id="T1:U657"><span class="var type1" id="S30T1U894">LocMaxEF</span> = <span class="mxinfo " id="T1:U659">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,276" id="srcline276">276</a></span><span class="line">    <span class="mxinfo " id="T1:U660"><span class="mxinfo " id="T1:U661"><span class="var type1" id="S27T3U899">SeqFinEF</span>(<span class="mxinfo " id="T1:U663">1</span>)</span>=<span class="mxinfo " id="T1:U664">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,277" id="srcline277">277</a></span><span class="line">    <span class="mxinfo " id="T1:U665"><span class="var type1" id="S33T1U904">MaxValEF</span> = <span class="mxinfo " id="T1:U667">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,278" id="srcline278">278</a></span><span class="line">    <span class="mxinfo " id="T1:U668"><span class="mxinfo " id="T1:U669"><span class="var type1" id="S24T3U909">InterEF</span>(<span class="mxinfo " id="T1:U671">1</span>)</span>=<span class="var type1" id="S2T1U911">LevDec1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,279" id="srcline279">279</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,280" id="srcline280">280</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U673">(<span class="mxinfo " id="T1:U674"><span class="mxinfo " id="T1:U675"><span class="var type1" id="S27T3U919">SeqFinEF</span>(<span class="var type1" id="S30T1U920">LocMaxEF</span>)</span>-<span class="mxinfo " id="T1:U678"><span class="var type1" id="S33T1U922">MaxValEF</span>/<span class="mxinfo " id="T1:U680">2</span></span></span>)&lt;<span class="mxinfo " id="T1:U681">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,281" id="srcline281">281</a></span><span class="line">        <span class="mxinfo " id="T1:U682"><span class="var type1" id="S2T1U927">LevDec1</span> = <span class="mxinfo " id="T1:U684">0.1877</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,282" id="srcline282">282</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,283" id="srcline283">283</a></span><span class="line">        <span class="mxinfo " id="T1:U685"><span class="var type1" id="S2T1U932">LevDec1</span> = <span class="mxinfo " id="T1:U687"><span class="var type1" id="S24T3U934">InterEF</span>(<span class="mxinfo " id="T1:U689">round(<span class="mxinfo " id="T1:U690"><span class="mxinfo " id="T1:U691"><span class="var type1" id="S27T3U939">SeqFinEF</span>(<span class="var type1" id="S30T1U940">LocMaxEF</span>)</span>-<span class="mxinfo " id="T1:U694"><span class="var type1" id="S33T1U942">MaxValEF</span>/<span class="mxinfo " id="T1:U696">2</span></span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,284" id="srcline284">284</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,285" id="srcline285">285</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,286" id="srcline286">286</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,287" id="srcline287">287</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,288" id="srcline288">288</a></span><span class="line"><span class="comment">%another way to measure the eye opening is the get all the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,289" id="srcline289">289</a></span><span class="line"><span class="comment">%boxes and find all peaks on it, that will be a plato created</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,290" id="srcline290">290</a></span><span class="line"><span class="comment">%by the sequences of ones (which was zeros). From thos peaks,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,291" id="srcline291">291</a></span><span class="line"><span class="comment">%the eye diagram will be the longer of them hence it will take</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,292" id="srcline292">292</a></span><span class="line"><span class="comment">%the most part of the vector that store the findpeaks result.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,293" id="srcline293">293</a></span><span class="line"><span class="comment">%Thus, the middle of the eye will be basically the middle of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,294" id="srcline294">294</a></span><span class="line"><span class="comment">%the peaks vector.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295">295</a></span><span class="line"><span class="mxinfo " id="T12:U697"><span class="var type1" id="S89T12U946">LocAB</span> = <span class="mxinfo " id="T12:U699">find(<span class="var type1" id="S73T11U949">EyeAB</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296">296</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U701">~<span class="mxinfo " id="T7:U702">any(<span class="var type1" id="S89T12U955">LocAB</span>)</span></span>                                              <span class="comment">%if for some reason there are no peaks, something went wrong.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,297" id="srcline297">297</a></span><span class="line">    <span class="mxinfo " id="T12:U704"><span class="var type1" id="S89T12U958">LocAB</span> = <span class="mxinfo " id="T1:U706">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,298" id="srcline298">298</a></span><span class="line">    <span class="mxinfo " id="T1:U707"><span class="var type1" id="S92T1U962">LevelDec3</span> = <span class="mxinfo " id="T1:U709">0.6953</span></span>;<span class="comment">%mean(Levels(3:4));                       %by default the decission level will be set to 0.65</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,299" id="srcline299">299</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,300" id="srcline300">300</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U710"><span class="var type1" id="S51T1U968">DecMod</span>==<span class="mxinfo " id="T1:U712">1</span></span><span class="comment">%InterAB(LocAB(round(end/2)))&lt;=LevDec3</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line">        <span class="mxinfo " id="T1:U713"><span class="var type1" id="S92T1U972">LevelDec3</span> = <span class="var type1" id="S4T1U973">LevDec3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line">        <span class="mxinfo " id="T1:U716"><span class="var type1" id="S92T1U977">LevelDec3</span> = <span class="mxinfo " id="T1:U718"><span class="var type1" id="S22T3U979">InterAB</span>(<span class="mxinfo " id="T1:U720"><span class="var type1" id="S89T12U981">LocAB</span>(<span class="mxinfo " id="T1:U722">round(<span class="mxinfo " id="T1:U723"><span class="mxinfo " id="T1:U724">end</span>/<span class="mxinfo " id="T1:U725">2</span></span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line"><span class="mxinfo " id="T12:U726"><span class="var type1" id="S93T12U990">LocCD</span> = <span class="mxinfo " id="T12:U728">find(<span class="var type1" id="S75T11U993">EyeCD</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U730">~<span class="mxinfo " id="T7:U731">any(<span class="var type1" id="S93T12U999">LocCD</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line">    <span class="mxinfo " id="T12:U733"><span class="var type1" id="S93T12U1002">LocCD</span> = <span class="mxinfo " id="T1:U735">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line">    <span class="mxinfo " id="T1:U736"><span class="var type1" id="S94T1U1006">LevelDec2</span> = <span class="mxinfo " id="T1:U738">0.4013</span></span>;<span class="comment">%mean(Levels(2:3));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311">311</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312">312</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U739"><span class="var type1" id="S51T1U1012">DecMod</span>==<span class="mxinfo " id="T1:U741">1</span></span><span class="comment">%InterCD(LocCD(round(end/2)))&gt;=LevDec2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313">313</a></span><span class="line">        <span class="mxinfo " id="T1:U742"><span class="var type1" id="S94T1U1016">LevelDec2</span> = <span class="var type1" id="S3T1U1017">LevDec2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314">314</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315">315</a></span><span class="line">        <span class="mxinfo " id="T1:U745"><span class="var type1" id="S94T1U1021">LevelDec2</span> = <span class="mxinfo " id="T1:U747"><span class="var type1" id="S23T3U1023">InterCD</span>(<span class="mxinfo " id="T1:U749"><span class="var type1" id="S93T12U1025">LocCD</span>(<span class="mxinfo " id="T1:U751">round(<span class="mxinfo " id="T1:U752"><span class="mxinfo " id="T1:U753">end</span>/<span class="mxinfo " id="T1:U754">2</span></span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316">316</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317">317</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318">318</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319">319</a></span><span class="line"><span class="mxinfo " id="T12:U755"><span class="var type1" id="S95T12U1034">LocEF</span> = <span class="mxinfo " id="T12:U757">find(<span class="var type1" id="S77T11U1037">EyeEF</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U759">~<span class="mxinfo " id="T7:U760">any(<span class="var type1" id="S95T12U1043">LocEF</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line">    <span class="mxinfo " id="T12:U762"><span class="var type1" id="S95T12U1046">LocEF</span> = <span class="mxinfo " id="T1:U764">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line">    <span class="mxinfo " id="T1:U765"><span class="var type1" id="S96T1U1050">LevelDec1</span> = <span class="mxinfo " id="T1:U767">0.1877</span></span>;<span class="comment">%mean(Levels(1:2));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,323" id="srcline323">323</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,324" id="srcline324">324</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U768"><span class="var type1" id="S51T1U1056">DecMod</span>==<span class="mxinfo " id="T1:U770">1</span></span><span class="comment">%InterEF(LocEF(round(end/2)))&lt;=LevDec1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,325" id="srcline325">325</a></span><span class="line">        <span class="mxinfo " id="T1:U771"><span class="var type1" id="S96T1U1060">LevelDec1</span> = <span class="var type1" id="S2T1U1061">LevDec1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,326" id="srcline326">326</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,327" id="srcline327">327</a></span><span class="line">        <span class="mxinfo " id="T1:U774"><span class="var type1" id="S96T1U1065">LevelDec1</span> = <span class="mxinfo " id="T1:U776"><span class="var type1" id="S24T3U1067">InterEF</span>(<span class="mxinfo " id="T1:U778"><span class="var type1" id="S95T12U1069">LocEF</span>(<span class="mxinfo " id="T1:U780">round(<span class="mxinfo " id="T1:U781"><span class="mxinfo " id="T1:U782">end</span>/<span class="mxinfo " id="T1:U783">2</span></span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,328" id="srcline328">328</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,329" id="srcline329">329</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,330" id="srcline330">330</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,331" id="srcline331">331</a></span><span class="line"><span class="mxinfo " id="T1:U784"><span class="var type1" id="S13T1U1078">AberLev1</span>  = <span class="mxinfo " id="T1:U786">abs(<span class="mxinfo " id="T1:U787"><span class="mxinfo " id="T1:U788"><span class="var type1" id="S22T3U1083">InterAB</span>(<span class="mxinfo " id="T1:U790"><span class="mxinfo " id="T1:U791"><span class="var type1" id="S25T3U1086">SeqFinAB</span>(<span class="var type1" id="S28T1U1087">LocMaxAB</span>)</span>-<span class="mxinfo " id="T1:U794">1</span></span>)</span> - <span class="mxinfo " id="T1:U795"><span class="var type1" id="S22T3U1090">InterAB</span>(<span class="mxinfo " id="T1:U797"><span class="mxinfo " id="T1:U798"><span class="mxinfo " id="T1:U799"><span class="var type1" id="S25T3U1094">SeqFinAB</span>(<span class="var type1" id="S28T1U1095">LocMaxAB</span>)</span>-<span class="var type1" id="S31T1U1096">MaxValAB</span></span>+<span class="mxinfo " id="T1:U803">1</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,332" id="srcline332">332</a></span><span class="line"><span class="mxinfo " id="T1:U804"><span class="var type1" id="S14T1U1100">AberLev2</span>  = <span class="mxinfo " id="T1:U806">abs(<span class="mxinfo " id="T1:U807"><span class="mxinfo " id="T1:U808"><span class="var type1" id="S23T3U1105">InterCD</span>(<span class="mxinfo " id="T1:U810"><span class="mxinfo " id="T1:U811"><span class="var type1" id="S26T3U1108">SeqFinCD</span>(<span class="var type1" id="S29T1U1109">LocMaxCD</span>)</span>-<span class="mxinfo " id="T1:U814">1</span></span>)</span> - <span class="mxinfo " id="T1:U815"><span class="var type1" id="S23T3U1112">InterCD</span>(<span class="mxinfo " id="T1:U817"><span class="mxinfo " id="T1:U818"><span class="mxinfo " id="T1:U819"><span class="var type1" id="S26T3U1116">SeqFinCD</span>(<span class="var type1" id="S29T1U1117">LocMaxCD</span>)</span>-<span class="var type1" id="S32T1U1118">MaxValCD</span></span>+<span class="mxinfo " id="T1:U823">1</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,333" id="srcline333">333</a></span><span class="line"><span class="mxinfo " id="T1:U824"><span class="var type1" id="S15T1U1122">AberLev3</span>  = <span class="mxinfo " id="T1:U826">abs(<span class="mxinfo " id="T1:U827"><span class="mxinfo " id="T1:U828"><span class="var type1" id="S24T3U1127">InterEF</span>(<span class="mxinfo " id="T1:U830"><span class="mxinfo " id="T1:U831"><span class="var type1" id="S27T3U1130">SeqFinEF</span>(<span class="var type1" id="S30T1U1131">LocMaxEF</span>)</span>-<span class="mxinfo " id="T1:U834">1</span></span>)</span> - <span class="mxinfo " id="T1:U835"><span class="var type1" id="S24T3U1134">InterEF</span>(<span class="mxinfo " id="T1:U837"><span class="mxinfo " id="T1:U838"><span class="mxinfo " id="T1:U839"><span class="var type1" id="S27T3U1138">SeqFinEF</span>(<span class="var type1" id="S30T1U1139">LocMaxEF</span>)</span>-<span class="var type1" id="S33T1U1140">MaxValEF</span></span>+<span class="mxinfo " id="T1:U843">1</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,334" id="srcline334">334</a></span><span class="line"><span class="mxinfo " id="T1:U844"><span class="var type1" id="S16T1U1144">ValsLev1</span>  = <span class="var type1" id="S4T1U1145">LevDec3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,335" id="srcline335">335</a></span><span class="line"><span class="mxinfo " id="T1:U847"><span class="var type1" id="S17T1U1148">ValsLev2</span>  = <span class="var type1" id="S3T1U1149">LevDec2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,336" id="srcline336">336</a></span><span class="line"><span class="mxinfo " id="T1:U850"><span class="var type1" id="S18T1U1152">ValsLev3</span>  = <span class="var type1" id="S2T1U1153">LevDec1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,337" id="srcline337">337</a></span><span class="line"><span class="mxinfo " id="T1:U853"><span class="var type1" id="S19T1U1156">ValsLev21</span> = <span class="mxinfo " id="T1:U855"><span class="var type1" id="S22T3U1158">InterAB</span>(<span class="mxinfo " id="T1:U857"><span class="var type1" id="S89T12U1160">LocAB</span>(<span class="mxinfo " id="T1:U859">round(<span class="mxinfo " id="T1:U860"><span class="mxinfo " id="T1:U861">length(<span class="var type1" id="S89T12U1166">LocAB</span>)</span>/<span class="mxinfo " id="T1:U863">2</span></span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,338" id="srcline338">338</a></span><span class="line"><span class="mxinfo " id="T1:U864"><span class="var type1" id="S20T1U1170">ValsLev22</span> = <span class="mxinfo " id="T1:U866"><span class="var type1" id="S23T3U1172">InterCD</span>(<span class="mxinfo " id="T1:U868"><span class="var type1" id="S93T12U1174">LocCD</span>(<span class="mxinfo " id="T1:U870">round(<span class="mxinfo " id="T1:U871"><span class="mxinfo " id="T1:U872">length(<span class="var type1" id="S93T12U1180">LocCD</span>)</span>/<span class="mxinfo " id="T1:U874">2</span></span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,339" id="srcline339">339</a></span><span class="line"><span class="mxinfo " id="T1:U875"><span class="var type1" id="S21T1U1184">ValsLev23</span> = <span class="mxinfo " id="T1:U877"><span class="var type1" id="S24T3U1186">InterEF</span>(<span class="mxinfo " id="T1:U879"><span class="var type1" id="S95T12U1188">LocEF</span>(<span class="mxinfo " id="T1:U881">round(<span class="mxinfo " id="T1:U882"><span class="mxinfo " id="T1:U883">length(<span class="var type1" id="S95T12U1194">LocEF</span>)</span>/<span class="mxinfo " id="T1:U885">2</span></span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,340" id="srcline340">340</a></span><span class="line"><span class="comment">%%      Actualy Receiving Data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,341" id="srcline341">341</a></span><span class="line"><span class="comment">%Once the signal was processed the next step is through a</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,342" id="srcline342">342</a></span><span class="line"><span class="comment">%comparator decide the actual information received.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,343" id="srcline343">343</a></span><span class="line"><span class="mxinfo " id="T2:U886"><span class="var type1" id="S98T2U1198">ThisDataSize</span> = <span class="mxinfo " id="T2:U888"><span class="mxinfo " id="T1:U889"><span class="var type1" id="S41T1U1202">NPPB</span>/<span class="mxinfo " id="T1:U891">2</span></span>:<span class="var type1" id="S41T1U1204">NPPB</span>:<span class="mxinfo " id="T1:U893">length(<span class="var type1" id="S5T2U1207">Ix</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,344" id="srcline344">344</a></span><span class="line"><span class="mxinfo " id="T2:U895"><span class="var type1" id="S12T2U1210">IxRec</span>    = <span class="mxinfo " id="T2:U897">zeros(<span class="mxinfo " id="T1:U898">1</span>,<span class="mxinfo " id="T1:U899"><span class="mxinfo " id="T1:U900">2</span>*<span class="mxinfo " id="T1:U901">size(<span class="var type1" id="S98T2U1218">ThisDataSize</span>,2)</span></span>)</span></span>;<span class="comment">%Initialization of the vector that will store the income data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,345" id="srcline345">345</a></span><span class="line"><span class="mxinfo " id="T2:U903"><span class="var type1" id="S11T2U1222">IxRecDef</span> = <span class="mxinfo " id="T2:U905">zeros(<span class="mxinfo " id="T1:U906">1</span>,<span class="mxinfo " id="T1:U907"><span class="mxinfo " id="T1:U908">2</span>*<span class="mxinfo " id="T1:U909">size(<span class="var type1" id="S98T2U1230">ThisDataSize</span>,2)</span></span>)</span></span>;<span class="comment">%Initialization of the vector that will store the income data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,346" id="srcline346">346</a></span><span class="line"><span class="mxinfo " id="T1:U911"><span class="var type1" id="S99T1U1234">ContBit</span>  = <span class="mxinfo " id="T1:U913">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,347" id="srcline347">347</a></span><span class="line"><span class="mxinfo " id="T1:U914"><span class="var type1" id="S100T1U1238">ContBit1</span>  = <span class="mxinfo " id="T1:U916">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,348" id="srcline348">348</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S88T1U1242">kk</span>=<span class="mxinfo " id="T1:U918">1</span>:length(<span class="var type1" id="S98T2U1247">ThisDataSize</span>)<span class="comment">%NPPB:length(Ix)                                       %The comparison process will be made for each symbol period</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,349" id="srcline349">349</a></span><span class="line">    <span class="comment">%                 midaux = round(mean(SymLoc(1:round(end/2))));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,350" id="srcline350">350</a></span><span class="line">    <span class="mxinfo " id="T1:U920"><span class="var type1" id="S101T1U1250">midaux</span> = <span class="mxinfo " id="T1:U922"><span class="var type1" id="S41T1U1252">NPPB</span>/<span class="mxinfo " id="T1:U924">2</span></span></span>;<span class="comment">%SymLoc(1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,351" id="srcline351">351</a></span><span class="line">    <span class="mxinfo " id="T1:U925"><span class="var type1" id="S102T1U1256">aux1</span> = <span class="mxinfo " id="T1:U927"><span class="var type1" id="S5T2U1258">Ix</span>(<span class="mxinfo " id="T1:U929"><span class="mxinfo " id="T1:U930"><span class="mxinfo " id="T1:U931">(<span class="mxinfo " id="T1:U932"><span class="var type1" id="S88T1U1264">kk</span>-<span class="mxinfo " id="T1:U934">1</span></span>)*<span class="var type1" id="S41T1U1266">NPPB</span></span>+<span class="var type1" id="S101T1U1267">midaux</span></span>+<span class="mxinfo " id="T1:U937">1</span></span>)</span></span>;     <span class="comment">%An small portion of the income signal is take for evaluation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,352" id="srcline352">352</a></span><span class="line">    <span class="mxinfo " id="T1:U938"><span class="var type1" id="S103T1U1271">MeanRec</span> = <span class="mxinfo " id="T1:U940">mean(<span class="var type1" id="S102T1U1274">aux1</span>)</span></span>;                                      <span class="comment">%Measuring the avarage value of the samples taken</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,353" id="srcline353">353</a></span><span class="line">    <span class="comment">%Verifying the interval for each symbol received.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,354" id="srcline354">354</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U942"><span class="var type1" id="S103T1U1278">MeanRec</span> &lt;= <span class="var type1" id="S96T1U1279">LevelDec1</span></span>                                    <span class="comment">%If it is the lowest level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,355" id="srcline355">355</a></span><span class="line">        <span class="mxinfo " id="T1:U945"><span class="mxinfo " id="T1:U946"><span class="var type1" id="S12T2U1283">IxRec</span>(<span class="var type1" id="S99T1U1284">ContBit</span>)</span> = <span class="mxinfo " id="T1:U949">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,356" id="srcline356">356</a></span><span class="line">        <span class="mxinfo " id="T1:U950"><span class="var type1" id="S99T1U1288">ContBit</span>  = <span class="mxinfo " id="T1:U952"><span class="mxinfo " id="T1:U953">1</span> + <span class="var type1" id="S99T1U1291">ContBit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,357" id="srcline357">357</a></span><span class="line">        <span class="mxinfo " id="T1:U955"><span class="mxinfo " id="T1:U956"><span class="var type1" id="S12T2U1295">IxRec</span>(<span class="var type1" id="S99T1U1296">ContBit</span>)</span> = <span class="mxinfo " id="T1:U959">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,358" id="srcline358">358</a></span><span class="line">        <span class="mxinfo " id="T1:U960"><span class="var type1" id="S99T1U1300">ContBit</span>  = <span class="mxinfo " id="T1:U962"><span class="mxinfo " id="T1:U963">1</span> + <span class="var type1" id="S99T1U1303">ContBit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,359" id="srcline359">359</a></span><span class="line">        <span class="comment">%IxRec = [IxRec 0 0];                                   %is 01 (1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,360" id="srcline360">360</a></span><span class="line">    <span class="keyword">elseif</span> (<span class="mxinfo " id="T7:U965"><span class="var type1" id="S103T1U1308">MeanRec</span> &lt;= <span class="var type1" id="S94T1U1309">LevelDec2</span></span>)&amp;&amp;(<span class="mxinfo " id="T7:U968"><span class="var type1" id="S103T1U1312">MeanRec</span> &gt; <span class="var type1" id="S96T1U1313">LevelDec1</span></span>)       <span class="comment">%If it is the second level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,361" id="srcline361">361</a></span><span class="line">        <span class="mxinfo " id="T1:U971"><span class="mxinfo " id="T1:U972"><span class="var type1" id="S12T2U1317">IxRec</span>(<span class="var type1" id="S99T1U1318">ContBit</span>)</span> = <span class="mxinfo " id="T1:U975">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,362" id="srcline362">362</a></span><span class="line">        <span class="mxinfo " id="T1:U976"><span class="var type1" id="S99T1U1322">ContBit</span>  = <span class="mxinfo " id="T1:U978"><span class="mxinfo " id="T1:U979">1</span> + <span class="var type1" id="S99T1U1325">ContBit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,363" id="srcline363">363</a></span><span class="line">        <span class="mxinfo " id="T1:U981"><span class="mxinfo " id="T1:U982"><span class="var type1" id="S12T2U1329">IxRec</span>(<span class="var type1" id="S99T1U1330">ContBit</span>)</span> = <span class="mxinfo " id="T1:U985">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,364" id="srcline364">364</a></span><span class="line">        <span class="mxinfo " id="T1:U986"><span class="var type1" id="S99T1U1334">ContBit</span>  = <span class="mxinfo " id="T1:U988"><span class="mxinfo " id="T1:U989">1</span> + <span class="var type1" id="S99T1U1337">ContBit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,365" id="srcline365">365</a></span><span class="line">        <span class="comment">%IxRec = [IxRec 0 1];                                   %is 00 (0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,366" id="srcline366">366</a></span><span class="line">    <span class="keyword">elseif</span> (<span class="mxinfo " id="T7:U991"><span class="var type1" id="S103T1U1342">MeanRec</span> &lt;= <span class="var type1" id="S92T1U1343">LevelDec3</span></span>)&amp;&amp;(<span class="mxinfo " id="T7:U994"><span class="var type1" id="S103T1U1346">MeanRec</span> &gt; <span class="var type1" id="S94T1U1347">LevelDec2</span></span>)       <span class="comment">%If it is the tird level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,367" id="srcline367">367</a></span><span class="line">        <span class="mxinfo " id="T1:U997"><span class="mxinfo " id="T1:U998"><span class="var type1" id="S12T2U1351">IxRec</span>(<span class="var type1" id="S99T1U1352">ContBit</span>)</span> = <span class="mxinfo " id="T1:U1001">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,368" id="srcline368">368</a></span><span class="line">        <span class="mxinfo " id="T1:U1002"><span class="var type1" id="S99T1U1356">ContBit</span>  = <span class="mxinfo " id="T1:U1004"><span class="mxinfo " id="T1:U1005">1</span> + <span class="var type1" id="S99T1U1359">ContBit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,369" id="srcline369">369</a></span><span class="line">        <span class="mxinfo " id="T1:U1007"><span class="mxinfo " id="T1:U1008"><span class="var type1" id="S12T2U1363">IxRec</span>(<span class="var type1" id="S99T1U1364">ContBit</span>)</span> = <span class="mxinfo " id="T1:U1011">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,370" id="srcline370">370</a></span><span class="line">        <span class="mxinfo " id="T1:U1012"><span class="var type1" id="S99T1U1368">ContBit</span>  = <span class="mxinfo " id="T1:U1014"><span class="mxinfo " id="T1:U1015">1</span> + <span class="var type1" id="S99T1U1371">ContBit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,371" id="srcline371">371</a></span><span class="line">        <span class="comment">%IxRec = [IxRec 1 1];                                   %is 10 (2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,372" id="srcline372">372</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo " id="T7:U1017"><span class="var type1" id="S103T1U1374">MeanRec</span> &gt; <span class="var type1" id="S92T1U1375">LevelDec3</span></span>                                 <span class="comment">%If it is the uper level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,373" id="srcline373">373</a></span><span class="line">        <span class="mxinfo " id="T1:U1020"><span class="mxinfo " id="T1:U1021"><span class="var type1" id="S12T2U1379">IxRec</span>(<span class="var type1" id="S99T1U1380">ContBit</span>)</span> = <span class="mxinfo " id="T1:U1024">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,374" id="srcline374">374</a></span><span class="line">        <span class="mxinfo " id="T1:U1025"><span class="var type1" id="S99T1U1384">ContBit</span>  = <span class="mxinfo " id="T1:U1027"><span class="mxinfo " id="T1:U1028">1</span> + <span class="var type1" id="S99T1U1387">ContBit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,375" id="srcline375">375</a></span><span class="line">        <span class="mxinfo " id="T1:U1030"><span class="mxinfo " id="T1:U1031"><span class="var type1" id="S12T2U1391">IxRec</span>(<span class="var type1" id="S99T1U1392">ContBit</span>)</span> = <span class="mxinfo " id="T1:U1034">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,376" id="srcline376">376</a></span><span class="line">        <span class="mxinfo " id="T1:U1035"><span class="var type1" id="S99T1U1396">ContBit</span>  = <span class="mxinfo " id="T1:U1037"><span class="mxinfo " id="T1:U1038">1</span> + <span class="var type1" id="S99T1U1399">ContBit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,377" id="srcline377">377</a></span><span class="line">        <span class="comment">%IxRec = [IxRec 1 0];                                   %is 11 (3)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,378" id="srcline378">378</a></span><span class="line">    <span class="keyword">else</span>                                                       <span class="comment">%If for some misteriose reason neither of previous verification were sucedded</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,379" id="srcline379">379</a></span><span class="line">        <span class="mxinfo " id="T1:U1040"><span class="mxinfo " id="T1:U1041"><span class="var type1" id="S12T2U1404">IxRec</span>(<span class="var type1" id="S99T1U1405">ContBit</span>)</span> = <span class="mxinfo " id="T1:U1044">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,380" id="srcline380">380</a></span><span class="line">        <span class="mxinfo " id="T1:U1045"><span class="var type1" id="S99T1U1409">ContBit</span>  = <span class="mxinfo " id="T1:U1047"><span class="mxinfo " id="T1:U1048">1</span> + <span class="var type1" id="S99T1U1412">ContBit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,381" id="srcline381">381</a></span><span class="line">        <span class="mxinfo " id="T1:U1050"><span class="mxinfo " id="T1:U1051"><span class="var type1" id="S12T2U1416">IxRec</span>(<span class="var type1" id="S99T1U1417">ContBit</span>)</span> = <span class="mxinfo " id="T1:U1054">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,382" id="srcline382">382</a></span><span class="line">        <span class="mxinfo " id="T1:U1055"><span class="var type1" id="S99T1U1421">ContBit</span>  = <span class="mxinfo " id="T1:U1057"><span class="mxinfo " id="T1:U1058">1</span> + <span class="var type1" id="S99T1U1424">ContBit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,383" id="srcline383">383</a></span><span class="line">        <span class="comment">%IxRec = [IxRec 0 0];                                   %by default the current data is set to be 00 (0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,384" id="srcline384">384</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,385" id="srcline385">385</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,386" id="srcline386">386</a></span><span class="line">    <span class="comment">%Verifying the interval for each symbol received.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,387" id="srcline387">387</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U1060"><span class="var type1" id="S103T1U1428">MeanRec</span> &lt;= <span class="var type1" id="S9T1U1429">DecLevDef1</span></span>                                   <span class="comment">%If it is the lowest level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,388" id="srcline388">388</a></span><span class="line">        <span class="mxinfo " id="T1:U1063"><span class="mxinfo " id="T1:U1064"><span class="var type1" id="S11T2U1433">IxRecDef</span>(<span class="var type1" id="S100T1U1434">ContBit1</span>)</span> = <span class="mxinfo " id="T1:U1067">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,389" id="srcline389">389</a></span><span class="line">        <span class="mxinfo " id="T1:U1068"><span class="var type1" id="S100T1U1438">ContBit1</span>  = <span class="mxinfo " id="T1:U1070"><span class="mxinfo " id="T1:U1071">1</span> + <span class="var type1" id="S100T1U1441">ContBit1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,390" id="srcline390">390</a></span><span class="line">        <span class="mxinfo " id="T1:U1073"><span class="mxinfo " id="T1:U1074"><span class="var type1" id="S11T2U1445">IxRecDef</span>(<span class="var type1" id="S100T1U1446">ContBit1</span>)</span> = <span class="mxinfo " id="T1:U1077">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,391" id="srcline391">391</a></span><span class="line">        <span class="mxinfo " id="T1:U1078"><span class="var type1" id="S100T1U1450">ContBit1</span>  = <span class="mxinfo " id="T1:U1080"><span class="mxinfo " id="T1:U1081">1</span> + <span class="var type1" id="S100T1U1453">ContBit1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,392" id="srcline392">392</a></span><span class="line">        <span class="comment">%IxRecDef = [IxRecDef 0 0];                             %is 01 (1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,393" id="srcline393">393</a></span><span class="line">    <span class="keyword">elseif</span> (<span class="mxinfo " id="T7:U1083"><span class="var type1" id="S103T1U1458">MeanRec</span> &lt;= <span class="var type1" id="S8T1U1459">DecLevDef2</span></span>)&amp;&amp;(<span class="mxinfo " id="T7:U1086"><span class="var type1" id="S103T1U1462">MeanRec</span> &gt; <span class="var type1" id="S9T1U1463">DecLevDef1</span></span>)     <span class="comment">%If it is the second level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,394" id="srcline394">394</a></span><span class="line">        <span class="mxinfo " id="T1:U1089"><span class="mxinfo " id="T1:U1090"><span class="var type1" id="S11T2U1467">IxRecDef</span>(<span class="var type1" id="S100T1U1468">ContBit1</span>)</span> = <span class="mxinfo " id="T1:U1093">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,395" id="srcline395">395</a></span><span class="line">        <span class="mxinfo " id="T1:U1094"><span class="var type1" id="S100T1U1472">ContBit1</span>  = <span class="mxinfo " id="T1:U1096"><span class="mxinfo " id="T1:U1097">1</span> + <span class="var type1" id="S100T1U1475">ContBit1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,396" id="srcline396">396</a></span><span class="line">        <span class="mxinfo " id="T1:U1099"><span class="mxinfo " id="T1:U1100"><span class="var type1" id="S11T2U1479">IxRecDef</span>(<span class="var type1" id="S100T1U1480">ContBit1</span>)</span> = <span class="mxinfo " id="T1:U1103">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,397" id="srcline397">397</a></span><span class="line">        <span class="mxinfo " id="T1:U1104"><span class="var type1" id="S100T1U1484">ContBit1</span>  = <span class="mxinfo " id="T1:U1106"><span class="mxinfo " id="T1:U1107">1</span> + <span class="var type1" id="S100T1U1487">ContBit1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,398" id="srcline398">398</a></span><span class="line">        <span class="comment">%IxRecDef = [IxRecDef 0 1];                             %is 00 (0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,399" id="srcline399">399</a></span><span class="line">    <span class="keyword">elseif</span> (<span class="mxinfo " id="T7:U1109"><span class="var type1" id="S103T1U1492">MeanRec</span> &lt;= <span class="var type1" id="S7T1U1493">DecLevDef3</span></span>)&amp;&amp;(<span class="mxinfo " id="T7:U1112"><span class="var type1" id="S103T1U1496">MeanRec</span> &gt; <span class="var type1" id="S8T1U1497">DecLevDef2</span></span>)     <span class="comment">%If it is the tird level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,400" id="srcline400">400</a></span><span class="line">        <span class="mxinfo " id="T1:U1115"><span class="mxinfo " id="T1:U1116"><span class="var type1" id="S11T2U1501">IxRecDef</span>(<span class="var type1" id="S100T1U1502">ContBit1</span>)</span> = <span class="mxinfo " id="T1:U1119">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,401" id="srcline401">401</a></span><span class="line">        <span class="mxinfo " id="T1:U1120"><span class="var type1" id="S100T1U1506">ContBit1</span>  = <span class="mxinfo " id="T1:U1122"><span class="mxinfo " id="T1:U1123">1</span> + <span class="var type1" id="S100T1U1509">ContBit1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,402" id="srcline402">402</a></span><span class="line">        <span class="mxinfo " id="T1:U1125"><span class="mxinfo " id="T1:U1126"><span class="var type1" id="S11T2U1513">IxRecDef</span>(<span class="var type1" id="S100T1U1514">ContBit1</span>)</span> = <span class="mxinfo " id="T1:U1129">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,403" id="srcline403">403</a></span><span class="line">        <span class="mxinfo " id="T1:U1130"><span class="var type1" id="S100T1U1518">ContBit1</span>  = <span class="mxinfo " id="T1:U1132"><span class="mxinfo " id="T1:U1133">1</span> + <span class="var type1" id="S100T1U1521">ContBit1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,404" id="srcline404">404</a></span><span class="line">        <span class="comment">%IxRecDef = [IxRecDef 1 1];                             %is 10 (2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,405" id="srcline405">405</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo " id="T7:U1135"><span class="var type1" id="S103T1U1524">MeanRec</span> &gt; <span class="var type1" id="S7T1U1525">DecLevDef3</span></span>                                <span class="comment">%If it is the uper level the incoming data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,406" id="srcline406">406</a></span><span class="line">        <span class="mxinfo " id="T1:U1138"><span class="mxinfo " id="T1:U1139"><span class="var type1" id="S11T2U1529">IxRecDef</span>(<span class="var type1" id="S100T1U1530">ContBit1</span>)</span> = <span class="mxinfo " id="T1:U1142">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,407" id="srcline407">407</a></span><span class="line">        <span class="mxinfo " id="T1:U1143"><span class="var type1" id="S100T1U1534">ContBit1</span>  = <span class="mxinfo " id="T1:U1145"><span class="mxinfo " id="T1:U1146">1</span> + <span class="var type1" id="S100T1U1537">ContBit1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,408" id="srcline408">408</a></span><span class="line">        <span class="mxinfo " id="T1:U1148"><span class="mxinfo " id="T1:U1149"><span class="var type1" id="S11T2U1541">IxRecDef</span>(<span class="var type1" id="S100T1U1542">ContBit1</span>)</span> = <span class="mxinfo " id="T1:U1152">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,409" id="srcline409">409</a></span><span class="line">        <span class="mxinfo " id="T1:U1153"><span class="var type1" id="S100T1U1546">ContBit1</span>  = <span class="mxinfo " id="T1:U1155"><span class="mxinfo " id="T1:U1156">1</span> + <span class="var type1" id="S100T1U1549">ContBit1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,410" id="srcline410">410</a></span><span class="line">        <span class="comment">%IxRecDef = [IxRecDef 1 0];                             %is 11 (3)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,411" id="srcline411">411</a></span><span class="line">    <span class="keyword">else</span>                                                       <span class="comment">%If for some misteriose reason neither of previous verification were sucedded</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,412" id="srcline412">412</a></span><span class="line">        <span class="mxinfo " id="T1:U1158"><span class="mxinfo " id="T1:U1159"><span class="var type1" id="S11T2U1554">IxRecDef</span>(<span class="var type1" id="S100T1U1555">ContBit1</span>)</span> = <span class="mxinfo " id="T1:U1162">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,413" id="srcline413">413</a></span><span class="line">        <span class="mxinfo " id="T1:U1163"><span class="var type1" id="S100T1U1559">ContBit1</span>  = <span class="mxinfo " id="T1:U1165"><span class="mxinfo " id="T1:U1166">1</span> + <span class="var type1" id="S100T1U1562">ContBit1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,414" id="srcline414">414</a></span><span class="line">        <span class="mxinfo " id="T1:U1168"><span class="mxinfo " id="T1:U1169"><span class="var type1" id="S11T2U1566">IxRecDef</span>(<span class="var type1" id="S100T1U1567">ContBit1</span>)</span> = <span class="mxinfo " id="T1:U1172">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,415" id="srcline415">415</a></span><span class="line">        <span class="mxinfo " id="T1:U1173"><span class="var type1" id="S100T1U1571">ContBit1</span>  = <span class="mxinfo " id="T1:U1175"><span class="mxinfo " id="T1:U1176">1</span> + <span class="var type1" id="S100T1U1574">ContBit1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,416" id="srcline416">416</a></span><span class="line">        <span class="comment">%IxRecDef = [IxRecDef 0 0];                             %by default the current data is set to be 00 (0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,417" id="srcline417">417</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,418" id="srcline418">418</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,419" id="srcline419">419</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,420" id="srcline420">420</a></span><span class="line"><span class="mxinfo " id="T2:U1178"><span class="var type1" id="S105T2U1577">TxDataA</span> = <span class="mxinfo " id="T2:U1180"><span class="var type1" id="S46T5U1579">TxDataMat</span>(<span class="var type1" id="S47T1U1580">ThisCarr</span>,<span class="mxinfo " id="T6:U1183">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,421" id="srcline421">421</a></span><span class="line"><span class="mxinfo " id="T5:U1184"><span class="var type1" id="S106T5U1584">TxDataB</span> = <span class="mxinfo " id="T5:U1186">reshape(<span class="var type1" id="S105T2U1587">TxDataA</span>,<span class="var type1" id="S43T1U1588">Nb4Pam</span>,<span class="var type1" id="S42T1U1589">CurTesSiz</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,422" id="srcline422">422</a></span><span class="line"><span class="mxinfo " id="T5:U1190"><span class="var type1" id="S107T5U1592">TxDataC</span> = <span class="mxinfo " id="T5:U1192"><span class="var type1" id="S106T5U1594">TxDataB</span>(<span class="mxinfo " id="T2:U1194"><span class="mxinfo " id="T1:U1195"><span class="mxinfo " id="T1:U1196">1</span>+<span class="mxinfo " id="T1:U1197"><span class="mxinfo " id="T1:U1198">2</span>*<span class="var type1" id="S50T1U1600">SyncPeriod</span></span></span>:<span class="mxinfo " id="T1:U1200"><span class="mxinfo " id="T1:U1201">end</span>-<span class="mxinfo " id="T1:U1202"><span class="mxinfo " id="T1:U1203">2</span>*<span class="var type1" id="S50T1U1606">SyncPeriod</span></span></span></span>,<span class="mxinfo " id="T6:U1205">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,423" id="srcline423">423</a></span><span class="line"><span class="mxinfo " id="T2:U1206"><span class="var type1" id="S10T2U1610">TxData</span>  = <span class="mxinfo " id="T2:U1208">reshape(<span class="var type1" id="S107T5U1613">TxDataC</span>,1,<span class="mxinfo " id="T1:U1210"><span class="mxinfo " id="T1:U1211">size(<span class="var type1" id="S107T5U1618">TxDataC</span>,1)</span>*<span class="mxinfo " id="T1:U1213">size(<span class="var type1" id="S107T5U1622">TxDataC</span>,2)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,424" id="srcline424">424</a></span><span class="line"><span class="mxinfo " id="T1:U1215"><span class="var type1" id="S108T1U1626">BitErr</span> = <span class="mxinfo " id="T1:U1217">sum(<span class="mxinfo " id="T10:U1218">xor(<span class="var type1" id="S10T2U1631">TxData</span>,<span class="var type1" id="S12T2U1632">IxRec</span>)</span>)</span></span>;<span class="comment">%Comparison between the Transmited and received and counting the differences</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,425" id="srcline425">425</a></span><span class="line"><span class="mxinfo " id="T1:U1221"><span class="var type1" id="S111T1U1635">BitErrAux1</span> = <span class="var type1" id="S108T1U1636">BitErr</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,426" id="srcline426">426</a></span><span class="line"><span class="mxinfo " id="T1:U1224"><span class="var type1" id="S112T1U1639">BitErrAux2</span> = <span class="mxinfo " id="T1:U1226">sum(<span class="mxinfo " id="T10:U1227">xor(<span class="var type1" id="S10T2U1644">TxData</span>,<span class="var type1" id="S11T2U1645">IxRecDef</span>)</span>)</span></span>;<span class="comment">%Comparison between the Transmited and received and counting the differences</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,427" id="srcline427">427</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U1230"><span class="var type1" id="S108T1U1649">BitErr</span> ~= <span class="mxinfo " id="T1:U1232">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,428" id="srcline428">428</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U1233"><span class="var type1" id="S112T1U1654">BitErrAux2</span>&lt;<span class="var type1" id="S111T1U1655">BitErrAux1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,429" id="srcline429">429</a></span><span class="line">        <span class="mxinfo " id="T1:U1236"><span class="var type1" id="S108T1U1658">BitErr</span> = <span class="var type1" id="S112T1U1659">BitErrAux2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,430" id="srcline430">430</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,431" id="srcline431">431</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,432" id="srcline432">432</a></span><span class="line">    <span class="mxinfo " id="T1:U1239"><span class="var type1" id="S9T1U1663">DecLevDef1</span> = <span class="var type1" id="S96T1U1664">LevelDec1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,433" id="srcline433">433</a></span><span class="line">    <span class="mxinfo " id="T1:U1242"><span class="var type1" id="S8T1U1667">DecLevDef2</span> = <span class="var type1" id="S94T1U1668">LevelDec2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,434" id="srcline434">434</a></span><span class="line">    <span class="mxinfo " id="T1:U1245"><span class="var type1" id="S7T1U1671">DecLevDef3</span> = <span class="var type1" id="S92T1U1672">LevelDec3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,435" id="srcline435">435</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,436" id="srcline436">436</a></span><span class="line"><span class="mxinfo " id="T1:U1248"><span class="var type1" id="S6T1U1675">Ber4PAM</span> = <span class="mxinfo " id="T1:U1250"><span class="var type1" id="S108T1U1677">BitErr</span>/(<span class="mxinfo " id="T1:U1252">(<span class="mxinfo " id="T1:U1253"><span class="var type1" id="S43T1U1682">Nb4Pam</span>-(<span class="mxinfo " id="T1:U1255"><span class="mxinfo " id="T1:U1256">4</span>*<span class="var type1" id="S50T1U1686">SyncPeriod</span></span>)</span>)*<span class="var type1" id="S42T1U1687">CurTesSiz</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,437" id="srcline437">437</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,438" id="srcline438">438</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,439" id="srcline439">439</a></span><span class="line"></span></span>
</pre>
